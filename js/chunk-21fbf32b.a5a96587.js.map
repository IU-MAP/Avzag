{"version":3,"sources":["webpack:///./src/Phrasebook/CorpusEditor.vue?368e","webpack:///./src/Phrasebook/Context/Editor.vue?c6e9","webpack:///./src/Phrasebook/CorpusEditor.vue?00fb","webpack:///./src/Phrasebook/CorpusEditor.vue?4b9c","webpack:///./src/Phrasebook/CorpusEditor.vue","webpack:///./src/Phrasebook/Context/Editor.vue","webpack:///./src/Phrasebook/Context/Editor.vue?bfca","webpack:///./node_modules/uuid/dist/esm-browser/rng.js","webpack:///./node_modules/uuid/dist/esm-browser/regex.js","webpack:///./node_modules/uuid/dist/esm-browser/validate.js","webpack:///./node_modules/uuid/dist/esm-browser/stringify.js","webpack:///./node_modules/uuid/dist/esm-browser/v4.js","webpack:///./src/Phrasebook/CorpusEditor.vue?5859","webpack:///./src/Phrasebook/CorpusEditor.vue?95e4"],"names":["class","file","icon","header","addSection","s","key","id","is-on","section","name","type","removeSection","addPhrase","phrases","p","phrase","preview","removePhrase","addBlock","blocks","b","i","block","removeBlock","context","add","c","entity","tags","remove","components","EditorCard","props","emits","computed","get","this","modelValue","set","$emit","methods","push","splice","render","__scopeId","getRandomValues","rnds8","Uint8Array","rng","crypto","bind","msCrypto","Error","validate","uuid","test","byteToHex","toString","substr","stringify","arr","offset","arguments","length","undefined","toLowerCase","TypeError","v4","options","buf","rnds","random","ButtonAlert","VContext","ContextEditor","VBlock","BlockEditor","setup","defaultFile","filename","window","confirm","storage","contextSource","value","indexOf","states","display","text","transition","index","immediate","phraseContext","forEach","Set","split"],"mappings":"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","file":"js/chunk-21fbf32b.a5a96587.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CorpusEditor.vue?vue&type=style&index=1&id=65c392f5&lang=scss\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Editor.vue?vue&type=style&index=0&id=1519fa16&lang=scss&scoped=true\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CorpusEditor.vue?vue&type=style&index=0&id=65c392f5&lang=scss&scoped=true\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CorpusEditor.vue?vue&type=style&index=2&id=65c392f5&lang=scss&scoped=true\"","<template>\n  <div v-if=\"file\" class=\"section col-2 small grid\">\n    <div class=\"col-2\">\n      <EditorCard icon=\"topic\" header=\"sections\" @action=\"addSection\">\n        <template v-if=\"section\" #header>\n          <ButtonAlert @confirm=\"removeSection\" />\n        </template>\n        <div class=\"col scroll\">\n          <div v-for=\"s in file\" :key=\"s.id\" class=\"row\">\n            <btn icon=\"edit\" :is-on=\"section === s\" @click=\"section = s\" />\n            <input v-model=\"s.name\" class=\"flex\" type=\"text\" />\n          </div>\n        </div>\n      </EditorCard>\n      <EditorCard\n        v-if=\"section\"\n        icon=\"short_text\"\n        header=\"phrases\"\n        @action=\"addPhrase\"\n      >\n        <template v-if=\"phrase\" #header>\n          <ButtonAlert @confirm=\"removePhrase\" />\n        </template>\n        <div class=\"col scroll\">\n          <div v-for=\"p in section.phrases\" :key=\"p.id\" class=\"row\">\n            <btn icon=\"edit\" :is-on=\"phrase === p\" @click=\"phrase = p\" />\n            <input v-model=\"p.preview\" class=\"flex\" type=\"text\" />\n          </div>\n        </div>\n      </EditorCard>\n      <EditorCard\n        v-if=\"phrase\"\n        icon=\"account_tree\"\n        header=\"Blocks\"\n        @action=\"addBlock\"\n      >\n        <template v-if=\"block\" #header>\n          <ButtonAlert @confirm=\"removeBlock\" />\n        </template>\n        <VContext />\n        <div class=\"row-1 wrap block-editor\">\n          <div\n            v-for=\"(b, i) in phrase.blocks\"\n            :key=\"phrase.id + '--' + i\"\n            class=\"row\"\n          >\n            <btn icon=\"edit\" :is-on=\"block === b\" @click=\"block = b\" />\n            <VBlock :block=\"b\" />\n          </div>\n        </div>\n      </EditorCard>\n      <ContextEditor v-if=\"phrase\" v-model=\"phrase.context\" />\n    </div>\n    <BlockEditor v-if=\"block\" v-model=\"block\" @remove=\"removeBlock\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport ButtonAlert from \"@/components/ButtonAlert.vue\";\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport VContext from \"./Context/index.vue\";\nimport ContextEditor from \"./Context/Editor.vue\";\nimport VBlock from \"./Block/index.vue\";\nimport BlockEditor from \"./Block/Editor.vue\";\n\nimport { defineComponent, ref, provide, watch, toRaw } from \"vue\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { setupEditor } from \"@/editor\";\nimport { Block, Context, CorpusPhrase, CorpusSection } from \"./types\";\n\nexport default defineComponent({\n  components: {\n    ButtonAlert,\n    EditorCard,\n    VContext,\n    ContextEditor,\n    VBlock,\n    BlockEditor,\n  },\n  setup() {\n    const file = setupEditor<CorpusSection[]>({\n      defaultFile: {},\n      filename: () =>\n        window.confirm(\"You're resetting phrasebook corpus.\")\n          ? \"phrasebook\"\n          : \"\",\n      storage: \"editor.phrasebookCorpus\",\n    });\n    const section = ref({} as CorpusSection);\n    const phrase = ref({} as CorpusPhrase);\n    const block = ref({} as Block);\n    const context = ref({} as Context);\n    const contextSource = ref({} as Context);\n\n    provide(\"context\", context);\n    provide(\"contextSource\", contextSource);\n\n    watch(file, (file) => (section.value = file[file.length - 1]), {\n      immediate: true,\n    });\n    watch(\n      section,\n      (section) => {\n        if (section?.phrases)\n          phrase.value = section.phrases[section.phrases.length - 1];\n      },\n      { immediate: true }\n    );\n    watch(\n      () => phrase.value?.context,\n      (phraseContext) => {\n        if (phraseContext) {\n          context.value = {};\n          contextSource.value = {};\n          phraseContext.forEach(({ entity, tags }) => {\n            context.value[entity] = new Set();\n            contextSource.value[entity] = new Set(tags.split(\" \"));\n          });\n        }\n      },\n      { immediate: true }\n    );\n    watch(\n      phrase,\n      (phrase) => {\n        if (phrase?.blocks)\n          block.value = phrase.blocks[phrase.blocks.length - 1];\n      },\n      { immediate: true }\n    );\n\n    function addSection() {\n      const s = {\n        id: uuidv4(),\n        name: \"New section\",\n        phrases: [],\n      };\n      file.value.push(s);\n      section.value = s;\n    }\n    function removeSection() {\n      file.value.splice(toRaw(file.value).indexOf(toRaw(section.value)), 1);\n      section.value = file.value[file.value.length - 1];\n    }\n    function addPhrase() {\n      const p = {\n        id: uuidv4(),\n        preview: \"New phrase\",\n        context: [],\n        blocks: [],\n      };\n      section.value.phrases.push(p);\n      phrase.value = p;\n    }\n    function removePhrase() {\n      const phrases = toRaw(section.value.phrases);\n      phrases.splice(phrases.indexOf(toRaw(phrase.value)), 1);\n      phrase.value = phrases[phrases.length - 1];\n    }\n\n    function addBlock() {\n      block.value = {\n        states: [{ display: [{ text: \"new state\" }], transition: \"next\" }],\n      };\n      phrase.value.blocks.push(block.value);\n    }\n    function removeBlock() {\n      const blocks = toRaw(phrase.value.blocks);\n      const index = blocks.indexOf(toRaw(block.value));\n      blocks.splice(index, 1);\n      block.value = blocks[blocks.length - 1];\n    }\n\n    return {\n      file,\n      section,\n      phrase,\n      block,\n      addSection,\n      removeSection,\n      addPhrase,\n      removePhrase,\n      addBlock,\n      removeBlock,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n#header {\n  margin-top: -1 * map-get($margins, \"double\");\n  padding-top: 2 * map-get($margins, \"normal\");\n}\n.grid {\n  display: grid;\n  grid-template-columns: minmax(0, 1fr) minmax(0, 1.5fr);\n  gap: map-get($margins, \"double\");\n}\n@media only screen and (max-width: $mobile-width) {\n  .grid {\n    grid-template-columns: 100%;\n  }\n}\n</style>\n\n<style lang=\"scss\">\n.block-editor {\n  gap: 4px 8px;\n}\n</style>\n\n<style lang=\"scss\" scoped>\n.scroll {\n  max-height: 128px;\n}\n</style>\n","<template>\n  <EditorCard icon=\"widgets\" header=\"context\" @action=\"add\">\n    <div class=\"col scroll\">\n      <div v-for=\"(c, i) in context\" :key=\"i\" class=\"row\">\n        <input\n          v-model=\"c.entity\"\n          class=\"entity\"\n          :class=\"'colored-' + i\"\n          type=\"text\"\n        />\n        <input v-model=\"c.tags\" class=\"flex\" type=\"text\" />\n        <btn icon=\"clear\" @click=\"remove(i)\" />\n      </div>\n    </div>\n  </EditorCard>\n</template>\n\n<script>\nimport EditorCard from \"@/components/EditorCard\";\n\nexport default {\n  name: \"PhraseContextEditor\",\n  components: {\n    EditorCard,\n  },\n  props: [\"modelValue\"],\n  emits: [\"update:modelValue\"],\n  computed: {\n    context: {\n      get() {\n        return this.modelValue;\n      },\n      set(c) {\n        this.$emit(\"update:modelValue\", c);\n      },\n    },\n  },\n  methods: {\n    add() {\n      this.context.push({\n        entity: \"new entity\",\n        tags: \"tags\",\n      });\n    },\n    remove(i) {\n      this.context.splice(i, 1);\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.entity {\n  width: 96px;\n}\n.scroll {\n  max-height: 128px;\n}\n</style>\n","import { render } from \"./Editor.vue?vue&type=template&id=1519fa16&scoped=true\"\nimport script from \"./Editor.vue?vue&type=script&lang=js\"\nexport * from \"./Editor.vue?vue&type=script&lang=js\"\n\nimport \"./Editor.vue?vue&type=style&index=0&id=1519fa16&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-1519fa16\"\n\nexport default script","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;","\nimport ButtonAlert from \"@/components/ButtonAlert.vue\";\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport VContext from \"./Context/index.vue\";\nimport ContextEditor from \"./Context/Editor.vue\";\nimport VBlock from \"./Block/index.vue\";\nimport BlockEditor from \"./Block/Editor.vue\";\n\nimport { defineComponent, ref, provide, watch, toRaw } from \"vue\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { setupEditor } from \"@/editor\";\nimport { Block, Context, CorpusPhrase, CorpusSection } from \"./types\";\n\nexport default defineComponent({\n  components: {\n    ButtonAlert,\n    EditorCard,\n    VContext,\n    ContextEditor,\n    VBlock,\n    BlockEditor,\n  },\n  setup() {\n    const file = setupEditor<CorpusSection[]>({\n      defaultFile: {},\n      filename: () =>\n        window.confirm(\"You're resetting phrasebook corpus.\")\n          ? \"phrasebook\"\n          : \"\",\n      storage: \"editor.phrasebookCorpus\",\n    });\n    const section = ref({} as CorpusSection);\n    const phrase = ref({} as CorpusPhrase);\n    const block = ref({} as Block);\n    const context = ref({} as Context);\n    const contextSource = ref({} as Context);\n\n    provide(\"context\", context);\n    provide(\"contextSource\", contextSource);\n\n    watch(file, (file) => (section.value = file[file.length - 1]), {\n      immediate: true,\n    });\n    watch(\n      section,\n      (section) => {\n        if (section?.phrases)\n          phrase.value = section.phrases[section.phrases.length - 1];\n      },\n      { immediate: true }\n    );\n    watch(\n      () => phrase.value?.context,\n      (phraseContext) => {\n        if (phraseContext) {\n          context.value = {};\n          contextSource.value = {};\n          phraseContext.forEach(({ entity, tags }) => {\n            context.value[entity] = new Set();\n            contextSource.value[entity] = new Set(tags.split(\" \"));\n          });\n        }\n      },\n      { immediate: true }\n    );\n    watch(\n      phrase,\n      (phrase) => {\n        if (phrase?.blocks)\n          block.value = phrase.blocks[phrase.blocks.length - 1];\n      },\n      { immediate: true }\n    );\n\n    function addSection() {\n      const s = {\n        id: uuidv4(),\n        name: \"New section\",\n        phrases: [],\n      };\n      file.value.push(s);\n      section.value = s;\n    }\n    function removeSection() {\n      file.value.splice(toRaw(file.value).indexOf(toRaw(section.value)), 1);\n      section.value = file.value[file.value.length - 1];\n    }\n    function addPhrase() {\n      const p = {\n        id: uuidv4(),\n        preview: \"New phrase\",\n        context: [],\n        blocks: [],\n      };\n      section.value.phrases.push(p);\n      phrase.value = p;\n    }\n    function removePhrase() {\n      const phrases = toRaw(section.value.phrases);\n      phrases.splice(phrases.indexOf(toRaw(phrase.value)), 1);\n      phrase.value = phrases[phrases.length - 1];\n    }\n\n    function addBlock() {\n      block.value = {\n        states: [{ display: [{ text: \"new state\" }], transition: \"next\" }],\n      };\n      phrase.value.blocks.push(block.value);\n    }\n    function removeBlock() {\n      const blocks = toRaw(phrase.value.blocks);\n      const index = blocks.indexOf(toRaw(block.value));\n      blocks.splice(index, 1);\n      block.value = blocks[blocks.length - 1];\n    }\n\n    return {\n      file,\n      section,\n      phrase,\n      block,\n      addSection,\n      removeSection,\n      addPhrase,\n      removePhrase,\n      addBlock,\n      removeBlock,\n    };\n  },\n});\n","import { render } from \"./CorpusEditor.vue?vue&type=template&id=65c392f5&scoped=true\"\nimport script from \"./CorpusEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./CorpusEditor.vue?vue&type=script&lang=ts\"\n\nimport \"./CorpusEditor.vue?vue&type=style&index=0&id=65c392f5&lang=scss&scoped=true\"\nimport \"./CorpusEditor.vue?vue&type=style&index=1&id=65c392f5&lang=scss\"\nimport \"./CorpusEditor.vue?vue&type=style&index=2&id=65c392f5&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-65c392f5\"\n\nexport default script"],"sourceRoot":""}