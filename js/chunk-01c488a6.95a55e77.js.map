{"version":3,"sources":["webpack:///./src/components/ConfirmButton.vue","webpack:///./src/components/ConfirmButton.vue?2177","webpack:///./src/components/ConfirmButton.vue?2c30","webpack:///./node_modules/core-js/modules/es.object.values.js","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack:///./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack:///./src/Phrasebook/State/index.vue?4761","webpack:///./src/Phrasebook/Block/OrderEditor.vue","webpack:///./src/Phrasebook/Block/OrderEditor.vue?bf7d","webpack:///./src/Phrasebook/Block/OrderEditor.vue?81c1","webpack:///./node_modules/core-js/modules/es.array.some.js","webpack:///./src/components/ArrayShift.vue","webpack:///./src/components/ArrayShift.vue?a907","webpack:///./src/components/ArrayShift.vue?8746","webpack:///./src/Phrasebook/Context/index.vue?1f76","webpack:///./src/Phrasebook/Context/index.vue","webpack:///./src/Phrasebook/Context/index.vue?ec8a","webpack:///./src/Phrasebook/Context/index.vue?3f4e","webpack:///./node_modules/core-js/modules/es.array.flat-map.js","webpack:///./src/Phrasebook/Block/index.vue","webpack:///./src/Phrasebook/Block/index.vue?471d","webpack:///./src/Phrasebook/Block/index.vue?892b","webpack:///./node_modules/core-js/modules/es.array.unscopables.flat-map.js","webpack:///./src/components/EditorCard.vue","webpack:///./src/components/EditorCard.vue?73a3","webpack:///./src/components/EditorCard.vue?01ae","webpack:///./src/Phrasebook/utils.ts","webpack:///./src/Phrasebook/Block/index.vue?ba49","webpack:///./src/Phrasebook/Block/Editor.vue","webpack:///./src/Phrasebook/State/ConditionsEditor.vue","webpack:///./src/Phrasebook/State/ConditionsEditor.vue?3a5e","webpack:///./src/Phrasebook/State/ConditionsEditor.vue?407c","webpack:///./src/Phrasebook/State/TransitionEditor.vue","webpack:///./src/Phrasebook/State/TransitionEditor.vue?270b","webpack:///./src/Phrasebook/State/TransitionEditor.vue?2939","webpack:///./src/Phrasebook/State/TextsEditor.vue","webpack:///./src/Phrasebook/State/TextsEditor.vue?36cc","webpack:///./src/Phrasebook/State/TextsEditor.vue?b653","webpack:///./src/Phrasebook/Block/Editor.vue?a3d1","webpack:///./src/Phrasebook/Block/Editor.vue?7956","webpack:///./src/editor.ts","webpack:///./node_modules/core-js/modules/es.array.join.js","webpack:///./node_modules/core-js/internals/flatten-into-array.js","webpack:///./node_modules/core-js/modules/es.array.splice.js","webpack:///./src/Phrasebook/State/index.vue","webpack:///./src/Phrasebook/State/index.vue?b225","webpack:///./src/Phrasebook/State/index.vue?b39a","webpack:///./node_modules/core-js/modules/es.object.keys.js","webpack:///./src/components/EditorCard.vue?b021","webpack:///./node_modules/core-js/modules/es.array.index-of.js","webpack:///./src/components/ArrayCopy.vue","webpack:///./src/components/ArrayCopy.vue?9a56","webpack:///./src/components/ArrayCopy.vue?cf5d","webpack:///./src/Phrasebook/State/ConditionsEditor.vue?0d98"],"names":["class","icon","text","confirm","props","message","type","String","default","emits","setup","emit","window","render","$","$values","values","target","stat","O","_arrayWithoutHoles","arr","Array","isArray","arrayLikeToArray","_iterableToArray","iter","Symbol","iterator","Object","from","_nonIterableSpread","TypeError","_toConsumableArray","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","mphrase","header","add","phrase","id","blocks","vblocks","translation","context","b","i","key","Math","random","is-on","block","ref","el","push","item","remove","name","components","ArrayCopy","EditorCard","ArrayShift","ConfirmButton","Context","Block","modelValue","undefined","get","set","p","value","bs","pickLast","length","index","indexOf","splice","immediate","$some","some","arrayMethodIsStrict","arrayMethodUsesToLength","STRICT_METHOD","USES_TO_LENGTH","proto","forced","callbackfn","this","arguments","shift","array","a","to","any","translated","tags","tag","explicit","result","state","condition","conditions","entries","forEach","entity","Set","translate","d","k","map","filter","has","__scopeId","flattenIntoArray","toObject","toLength","aFunction","arraySpeciesCreate","flatMap","A","sourceLen","disabled","glossed","move","$event","VState","Boolean","transition","switchState","nextState","states","deep","addToUnscopables","button","caption","_","slots","newState","texts","plain","createContext","source","checkConditions","score","count","flag","findBestState","indexes","candidates","candidate","s","c","applyConditions","additive","delete","color","toggle","keys","mode","includes","t","m","stateIndex","colors","placeholder","ipa","gloss","entities","e","ConditionsEditor","TransitionEditor","TextsEditor","config","defaultFile","storage","filename","file","resetFile","JSON","parse","stringify","saveFile","localStorage","setupEditor","options","assign","IndexedObject","toIndexedObject","nativeJoin","join","ES3_STRINGS","separator","call","bind","original","start","depth","mapper","thisArg","element","targetIndex","sourceIndex","mapFn","module","exports","toAbsoluteIndex","toInteger","createProperty","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","ACCESSORS","0","1","max","min","MAX_SAFE_INTEGER","MAXIMUM_ALLOWED_LENGTH_EXCEEDED","deleteCount","insertCount","actualDeleteCount","len","actualStart","argumentsLength","canGloss","types","j","textColors","dashColors","lines","nativeKeys","fails","FAILS_ON_PRIMITIVES","it","$indexOf","nativeIndexOf","NEGATIVE_ZERO","searchElement","apply","copy"],"mappings":"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","file":"js/chunk-01c488a6.95a55e77.js","sourcesContent":["<template>\n  <btn\n    class=\"highlight-font-alert\"\n    :icon=\"icon\"\n    :text=\"text\"\n    @click=\"confirm\"\n  />\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  props: {\n    message: { type: String, default: \"Delete?\" },\n    icon: { type: String, default: \"delete\" },\n    text: { type: String, default: \"\" },\n  },\n  emits: [\"confirm\"],\n  setup(props, { emit }) {\n    function confirm() {\n      if (window.confirm(props.message)) emit(\"confirm\");\n    }\n    return { confirm };\n  },\n});\n</script>\n","\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  props: {\n    message: { type: String, default: \"Delete?\" },\n    icon: { type: String, default: \"delete\" },\n    text: { type: String, default: \"\" },\n  },\n  emits: [\"confirm\"],\n  setup(props, { emit }) {\n    function confirm() {\n      if (window.confirm(props.message)) emit(\"confirm\");\n    }\n    return { confirm };\n  },\n});\n","import { render } from \"./ConfirmButton.vue?vue&type=template&id=598fbbc7\"\nimport script from \"./ConfirmButton.vue?vue&type=script&lang=ts\"\nexport * from \"./ConfirmButton.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","var $ = require('../internals/export');\nvar $values = require('../internals/object-to-array').values;\n\n// `Object.values` method\n// https://tc39.es/ecma262/#sec-object.values\n$({ target: 'Object', stat: true }, {\n  values: function values(O) {\n    return $values(O);\n  }\n});\n","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithoutHoles from \"@babel/runtime/helpers/esm/arrayWithoutHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableSpread from \"@babel/runtime/helpers/esm/nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=661aca89&lang=scss&scoped=true\"","<template>\n  <EditorCard v-if=\"mphrase\" icon=\"widgets\" header=\"Blocks\" @action=\"add\">\n    <template v-if=\"block\" #header>\n      <ArrayCopy v-model=\"blocks\" v-model:item=\"block\" />\n      <ArrayShift v-model=\"blocks\" :item=\"block\" />\n      <ConfirmButton @confirm=\"remove\" />\n    </template>\n    <Context v-if=\"phrase.id\" />\n    <Context v-else :blocks=\"vblocks\" :translation=\"phrase.context\" />\n    <div class=\"row-1 wrap block-editor\">\n      <div v-for=\"(b, i) in blocks\" :key=\"i + '--' + Math.random()\" class=\"row\">\n        <btn icon=\"edit\" :is-on=\"block === b\" @click=\"block = b\" />\n        <Block :ref=\"(el) => (el ? vblocks.push(el) : null)\" :block=\"b\" />\n      </div>\n    </div>\n  </EditorCard>\n</template>\n\n<script lang=\"ts\">\nimport ArrayCopy from \"@/components/ArrayCopy.vue\";\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport ArrayShift from \"@/components/ArrayShift.vue\";\nimport ConfirmButton from \"@/components/ConfirmButton.vue\";\nimport Context from \"../Context/index.vue\";\nimport Block from \"./index.vue\";\n\nimport {\n  computed,\n  defineComponent,\n  onBeforeUpdate,\n  PropType,\n  ref,\n  toRaw,\n  watch,\n} from \"vue\";\nimport { Phrase, CorpusPhrase, State } from \"../types\";\nimport { newState } from \"../utils\";\n\nexport default defineComponent({\n  name: \"OrderEditor\",\n  components: {\n    ArrayCopy,\n    EditorCard,\n    ArrayShift,\n    ConfirmButton,\n    Context,\n    Block,\n  },\n  props: {\n    modelValue: {\n      type: Array as PropType<State[] | undefined>,\n      default: undefined,\n    },\n    phrase: {\n      type: Object as PropType<Phrase | CorpusPhrase>,\n      default: undefined,\n    },\n  },\n  emits: [\"update:modelValue\", \"update:phrase\"],\n  setup(props, { emit }) {\n    const mphrase = computed({\n      get: () => props.phrase,\n      set: (p) => emit(\"update:modelValue\", p),\n    });\n    const blocks = computed({\n      get: () => mphrase.value.blocks,\n      set: (bs) => (mphrase.value.blocks = bs),\n    });\n    const block = computed({\n      get: () => props.modelValue,\n      set: (b) => emit(\"update:modelValue\", b),\n    });\n    const vblocks = ref([]);\n    onBeforeUpdate(() => (vblocks.value = []));\n\n    function pickLast() {\n      block.value = blocks.value\n        ? blocks.value[blocks.value.length - 1]\n        : undefined;\n    }\n    watch(blocks, pickLast, {\n      immediate: true,\n    });\n\n    function add() {\n      if (!blocks.value) blocks.value = [];\n      blocks.value.push([newState()]);\n      pickLast();\n    }\n    function remove() {\n      if (!block.value) return;\n      const index = toRaw(blocks.value).indexOf(toRaw(block.value));\n      blocks.value.splice(index, 1);\n      pickLast();\n    }\n\n    return { mphrase, blocks, vblocks, block, add, remove };\n  },\n});\n</script>\n","\nimport ArrayCopy from \"@/components/ArrayCopy.vue\";\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport ArrayShift from \"@/components/ArrayShift.vue\";\nimport ConfirmButton from \"@/components/ConfirmButton.vue\";\nimport Context from \"../Context/index.vue\";\nimport Block from \"./index.vue\";\n\nimport {\n  computed,\n  defineComponent,\n  onBeforeUpdate,\n  PropType,\n  ref,\n  toRaw,\n  watch,\n} from \"vue\";\nimport { Phrase, CorpusPhrase, State } from \"../types\";\nimport { newState } from \"../utils\";\n\nexport default defineComponent({\n  name: \"OrderEditor\",\n  components: {\n    ArrayCopy,\n    EditorCard,\n    ArrayShift,\n    ConfirmButton,\n    Context,\n    Block,\n  },\n  props: {\n    modelValue: {\n      type: Array as PropType<State[] | undefined>,\n      default: undefined,\n    },\n    phrase: {\n      type: Object as PropType<Phrase | CorpusPhrase>,\n      default: undefined,\n    },\n  },\n  emits: [\"update:modelValue\", \"update:phrase\"],\n  setup(props, { emit }) {\n    const mphrase = computed({\n      get: () => props.phrase,\n      set: (p) => emit(\"update:modelValue\", p),\n    });\n    const blocks = computed({\n      get: () => mphrase.value.blocks,\n      set: (bs) => (mphrase.value.blocks = bs),\n    });\n    const block = computed({\n      get: () => props.modelValue,\n      set: (b) => emit(\"update:modelValue\", b),\n    });\n    const vblocks = ref([]);\n    onBeforeUpdate(() => (vblocks.value = []));\n\n    function pickLast() {\n      block.value = blocks.value\n        ? blocks.value[blocks.value.length - 1]\n        : undefined;\n    }\n    watch(blocks, pickLast, {\n      immediate: true,\n    });\n\n    function add() {\n      if (!blocks.value) blocks.value = [];\n      blocks.value.push([newState()]);\n      pickLast();\n    }\n    function remove() {\n      if (!block.value) return;\n      const index = toRaw(blocks.value).indexOf(toRaw(block.value));\n      blocks.value.splice(index, 1);\n      pickLast();\n    }\n\n    return { mphrase, blocks, vblocks, block, add, remove };\n  },\n});\n","import { render } from \"./OrderEditor.vue?vue&type=template&id=1914ef86\"\nimport script from \"./OrderEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./OrderEditor.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","'use strict';\nvar $ = require('../internals/export');\nvar $some = require('../internals/array-iteration').some;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar STRICT_METHOD = arrayMethodIsStrict('some');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('some');\n\n// `Array.prototype.some` method\n// https://tc39.es/ecma262/#sec-array.prototype.some\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || !USES_TO_LENGTH }, {\n  some: function some(callbackfn /* , thisArg */) {\n    return $some(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","<template>\n  <div class=\"row-0\">\n    <btn icon=\"keyboard_arrow_up\" @click=\"shift(-1)\" />\n    <btn icon=\"keyboard_arrow_down\" @click=\"shift(1)\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, toRaw } from \"vue\";\n\nexport default defineComponent({\n  props: {\n    modelValue: { type: Array, default: () => undefined },\n    item: { type: Object, default: undefined },\n  },\n  emits: [\"update:modelValue\"],\n  setup(props, { emit }) {\n    const array = computed({\n      get: () => props.modelValue,\n      set: (a) => emit(\"update:modelValue\", a),\n    });\n    function shift(shift: number) {\n      const length = array.value.length;\n      const from = toRaw(array.value).indexOf(toRaw(props.item));\n      const to = (from + shift + length) % length;\n      array.value.splice(to, 0, array.value.splice(from, 1)[0]);\n    }\n    return { shift };\n  },\n});\n</script>\n","\nimport { computed, defineComponent, toRaw } from \"vue\";\n\nexport default defineComponent({\n  props: {\n    modelValue: { type: Array, default: () => undefined },\n    item: { type: Object, default: undefined },\n  },\n  emits: [\"update:modelValue\"],\n  setup(props, { emit }) {\n    const array = computed({\n      get: () => props.modelValue,\n      set: (a) => emit(\"update:modelValue\", a),\n    });\n    function shift(shift: number) {\n      const length = array.value.length;\n      const from = toRaw(array.value).indexOf(toRaw(props.item));\n      const to = (from + shift + length) % length;\n      array.value.splice(to, 0, array.value.splice(from, 1)[0]);\n    }\n    return { shift };\n  },\n});\n","import { render } from \"./ArrayShift.vue?vue&type=template&id=bb228ba8\"\nimport script from \"./ArrayShift.vue?vue&type=script&lang=ts\"\nexport * from \"./ArrayShift.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=caacf090&lang=scss&scoped=true\"","<template>\n  <div class=\"row text-caption wrap\">\n    <div class=\"icon\">info</div>\n    <template v-if=\"any\">\n      <template v-for=\"(tags, i) of translated\" :key=\"i\">\n        <template v-if=\"tags.length\" class=\"row-0 wrap\">\n          <p\n            v-for=\"tag in tags\"\n            :key=\"tag + '--' + i\"\n            :class=\"'colored-dot-' + i\"\n          >\n            {{ tag }}\n          </p>\n        </template>\n      </template>\n    </template>\n    <template v-else>…</template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, inject, Ref, PropType } from \"vue\";\nimport { Context, ContextTranslation, VBlock } from \"../types\";\n\nexport default defineComponent({\n  name: \"Context\",\n  props: {\n    translation: {\n      type: Object as PropType<ContextTranslation>,\n      default: () => ({}),\n    },\n    blocks: { type: Array as PropType<VBlock[]>, default: () => [] },\n  },\n  setup(props) {\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    const explicit = computed(() => {\n      const result = {} as Context;\n      for (const { state } of props.blocks) {\n        const condition = state?.conditions;\n        if (!condition) continue;\n        Object.entries(condition).forEach(([entity, tags]) =>\n          Object.entries(tags).forEach(([tag]) => {\n            if (!result[entity]) result[entity] = new Set();\n            result[entity].add(tag);\n          })\n        );\n      }\n      return result;\n    });\n\n    function translate(d: undefined | Record<string, string>, k: string) {\n      return d?.[k] || k;\n    }\n    const translated = computed(() =>\n      Object.entries(context.value).map(([entity, tags]) =>\n        [...tags]\n          .filter((tag) => !explicit.value[entity]?.has(tag))\n          .map((tag) => translate(props.translation?.[entity], tag))\n      )\n    );\n    const any = computed(() => translated.value.some((tags) => tags?.length));\n\n    return { translated, any };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\ndiv.icon {\n  font-size: map-get($font-sizes, \"small\");\n}\np:not(:last-child)::after {\n  content: \",\";\n}\n</style>\n","\nimport { computed, defineComponent, inject, Ref, PropType } from \"vue\";\nimport { Context, ContextTranslation, VBlock } from \"../types\";\n\nexport default defineComponent({\n  name: \"Context\",\n  props: {\n    translation: {\n      type: Object as PropType<ContextTranslation>,\n      default: () => ({}),\n    },\n    blocks: { type: Array as PropType<VBlock[]>, default: () => [] },\n  },\n  setup(props) {\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    const explicit = computed(() => {\n      const result = {} as Context;\n      for (const { state } of props.blocks) {\n        const condition = state?.conditions;\n        if (!condition) continue;\n        Object.entries(condition).forEach(([entity, tags]) =>\n          Object.entries(tags).forEach(([tag]) => {\n            if (!result[entity]) result[entity] = new Set();\n            result[entity].add(tag);\n          })\n        );\n      }\n      return result;\n    });\n\n    function translate(d: undefined | Record<string, string>, k: string) {\n      return d?.[k] || k;\n    }\n    const translated = computed(() =>\n      Object.entries(context.value).map(([entity, tags]) =>\n        [...tags]\n          .filter((tag) => !explicit.value[entity]?.has(tag))\n          .map((tag) => translate(props.translation?.[entity], tag))\n      )\n    );\n    const any = computed(() => translated.value.some((tags) => tags?.length));\n\n    return { translated, any };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=caacf090&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=caacf090&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-caacf090\"\n\nexport default script","'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar aFunction = require('../internals/a-function');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flatMap` method\n// https://tc39.es/ecma262/#sec-array.prototype.flatmap\n$({ target: 'Array', proto: true }, {\n  flatMap: function flatMap(callbackfn /* , thisArg */) {\n    var O = toObject(this);\n    var sourceLen = toLength(O.length);\n    var A;\n    aFunction(callbackfn);\n    A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, 1, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return A;\n  }\n});\n","<template>\n  <button\n    v-show=\"text\"\n    v-if=\"state\"\n    class=\"small\"\n    :class=\"{ disabled, glossed }\"\n    @click=\"move\"\n  >\n    <VState :glossed=\"glossed\" :state=\"state\" @text=\"text = $event\" />\n  </button>\n</template>\n\n<script lang=\"ts\">\nimport VState from \"../State/index.vue\";\n\nimport {\n  computed,\n  defineComponent,\n  inject,\n  PropType,\n  ref,\n  Ref,\n  toRaw,\n  watch,\n} from \"vue\";\nimport { Context, State } from \"../types\";\nimport { applyConditions, findBestState, checkConditions } from \"../utils\";\n\nexport default defineComponent({\n  name: \"Block\",\n  components: { VState },\n  props: {\n    block: { type: Array as PropType<State[]>, default: undefined },\n    glossed: Boolean,\n  },\n  emits: [\"update:modelValue\"],\n  setup(props) {\n    const state = ref<State>();\n    const disabled = computed(() => !state.value?.transition);\n    const text = ref(\"\");\n\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    function switchState(nextState: undefined | State) {\n      if (toRaw(nextState) === toRaw(state.value)) return;\n      applyConditions(context, state.value?.conditions, false);\n      applyConditions(context, nextState?.conditions, true);\n      state.value = nextState;\n    }\n    watch(\n      context,\n      (context) => {\n        const nextState = findBestState(undefined, props.block, context);\n        switchState(nextState);\n      },\n      { immediate: true, deep: true }\n    );\n\n    function move() {\n      if (disabled.value) return;\n      const transition = state.value?.transition;\n      const states = props.block;\n      let nextState;\n\n      if (transition === \"next\") {\n        const i = state.value ? states.indexOf(toRaw(state.value)) : -1;\n        nextState = states[(i + 1) % states.length];\n      } else if (transition)\n        nextState = findBestState(transition, states, context.value);\n\n      switchState(nextState);\n      if (checkConditions(nextState?.conditions, context.value)[0] < 0)\n        state.value = undefined;\n    }\n\n    return {\n      move,\n      state,\n      disabled,\n      text,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\nbutton {\n  height: fit-content;\n  padding: 0;\n  &.disabled {\n    padding: 0;\n    background-color: transparent;\n    &:hover,\n    &:active {\n      background-color: transparent;\n    }\n    cursor: default;\n  }\n  &:not(.disabled) > * {\n    padding: 0 map-get($margins, \"normal\");\n  }\n}\n</style>\n","\nimport VState from \"../State/index.vue\";\n\nimport {\n  computed,\n  defineComponent,\n  inject,\n  PropType,\n  ref,\n  Ref,\n  toRaw,\n  watch,\n} from \"vue\";\nimport { Context, State } from \"../types\";\nimport { applyConditions, findBestState, checkConditions } from \"../utils\";\n\nexport default defineComponent({\n  name: \"Block\",\n  components: { VState },\n  props: {\n    block: { type: Array as PropType<State[]>, default: undefined },\n    glossed: Boolean,\n  },\n  emits: [\"update:modelValue\"],\n  setup(props) {\n    const state = ref<State>();\n    const disabled = computed(() => !state.value?.transition);\n    const text = ref(\"\");\n\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    function switchState(nextState: undefined | State) {\n      if (toRaw(nextState) === toRaw(state.value)) return;\n      applyConditions(context, state.value?.conditions, false);\n      applyConditions(context, nextState?.conditions, true);\n      state.value = nextState;\n    }\n    watch(\n      context,\n      (context) => {\n        const nextState = findBestState(undefined, props.block, context);\n        switchState(nextState);\n      },\n      { immediate: true, deep: true }\n    );\n\n    function move() {\n      if (disabled.value) return;\n      const transition = state.value?.transition;\n      const states = props.block;\n      let nextState;\n\n      if (transition === \"next\") {\n        const i = state.value ? states.indexOf(toRaw(state.value)) : -1;\n        nextState = states[(i + 1) % states.length];\n      } else if (transition)\n        nextState = findBestState(transition, states, context.value);\n\n      switchState(nextState);\n      if (checkConditions(nextState?.conditions, context.value)[0] < 0)\n        state.value = undefined;\n    }\n\n    return {\n      move,\n      state,\n      disabled,\n      text,\n    };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=354bd589&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=354bd589&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-354bd589\"\n\nexport default script","// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('flatMap');\n","<template>\n  <div class=\"col\">\n    <div class=\"row card-0\">\n      <btn v-if=\"button\" :icon=\"button\" @click=\"emit('action')\" />\n      <p class=\"icon\">{{ icon }}</p>\n      <h2 class=\"flex\">{{ header }}</h2>\n      <slot name=\"header\" />\n    </div>\n    <p v-if=\"caption\" class=\"text-caption text-faded\">\n      <slot name=\"caption\" />\n    </p>\n    <div class=\"col\">\n      <slot />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"EditorCard\",\n  props: {\n    button: { type: String, default: \"add\" },\n    icon: { type: String, default: \"\" },\n    header: { type: String, default: \"\" },\n  },\n  emits: [\"action\"],\n  setup(_, { emit, slots }) {\n    return { emit, caption: slots.caption };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.text-caption:empty {\n  display: none;\n}\n.card-0 {\n  min-height: map-get($button-height, \"small\") + 2 * map-get($margins, \"half\");\n}\n</style>\n","\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"EditorCard\",\n  props: {\n    button: { type: String, default: \"add\" },\n    icon: { type: String, default: \"\" },\n    header: { type: String, default: \"\" },\n  },\n  emits: [\"action\"],\n  setup(_, { emit, slots }) {\n    return { emit, caption: slots.caption };\n  },\n});\n","import { render } from \"./EditorCard.vue?vue&type=template&id=245b6f20&scoped=true\"\nimport script from \"./EditorCard.vue?vue&type=script&lang=ts\"\nexport * from \"./EditorCard.vue?vue&type=script&lang=ts\"\n\nimport \"./EditorCard.vue?vue&type=style&index=0&id=245b6f20&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-245b6f20\"\n\nexport default script","import { Ref } from \"vue\";\nimport { Context, State, Conditions, ContextSource } from \"./types\";\n\nexport function newState() {\n  return {\n    texts: [{ plain: \"new state\" }],\n    transition: \"next\",\n    conditions: {},\n  } as State;\n}\n\nexport function createContext(context: Ref<Context>, source?: ContextSource[]) {\n  if (!source) return;\n  context.value = {};\n  source.forEach(({ entity }) => (context.value[entity] = new Set()));\n}\n\nexport function checkConditions(\n  conditions: undefined | Conditions,\n  context: Context\n): [number, number] {\n  if (!conditions) return [1, 0];\n  let score = 0;\n  let count = 0;\n  for (const [entity, tags] of Object.entries(conditions))\n    for (const [tag, flag] of Object.entries(tags)) {\n      const has = context[entity]?.has(tag);\n      if (!flag && !has) return [-1, 0];\n      if (has) score += 1;\n      count += 1;\n    }\n  return [score / (count || 1), count];\n}\n\nexport function findBestState(\n  indexes: undefined | number[],\n  states: State[],\n  context: Context\n): undefined | State {\n  let state;\n  let score = -1;\n  let count = 0;\n\n  const candidates = indexes?.map((i) => states[i]) ?? states;\n  candidates.forEach((candidate) => {\n    const [s, c] = checkConditions(candidate.conditions, context);\n    if (score === 1 ? s === 1 && c > count : s > score) {\n      state = candidate;\n      score = s;\n      count = c;\n    }\n  });\n  return state;\n}\n\nexport function applyConditions(\n  context: Ref<Context>,\n  conditions: undefined | Conditions,\n  additive: boolean\n) {\n  if (!conditions || !context.value) return;\n  Object.entries(conditions).forEach(([entity, tags]) =>\n    Object.entries(tags).forEach(([tag, flag]) => {\n      const set = context.value[entity];\n      if (!flag || !set) return;\n      if (additive) set.add(tag);\n      else set.delete(tag);\n    })\n  );\n}\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=354bd589&lang=scss&scoped=true\"","<template>\n  <div v-if=\"block\" class=\"block col-2\">\n    <EditorCard icon=\"account_tree\" header=\"States\" @action=\"add\">\n      <template v-if=\"state\" #header>\n        <toggle v-model=\"glossed\" icon=\"layers\" />\n        <ArrayCopy v-model=\"block\" v-model:item=\"state\" />\n        <ArrayShift v-model=\"block\" :item=\"state\" />\n        <ConfirmButton @confirm=\"remove\" />\n      </template>\n      <div class=\"row-1 wrap block-editor\">\n        <div v-for=\"(s, i) in block\" :key=\"i\" class=\"row\">\n          <btn icon=\"edit\" :is-on=\"state === s\" @click=\"state = s\" />\n          <VState :state=\"s\" :glossed=\"glossed\" />\n        </div>\n      </div>\n    </EditorCard>\n    <template v-if=\"state\">\n      <TextsEditor v-model=\"state.texts\" />\n      <ConditionsEditor v-model=\"state.conditions\" />\n      <TransitionEditor v-model=\"state.transition\" :states=\"block\" />\n    </template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport ConfirmButton from \"@/components/ConfirmButton.vue\";\nimport ArrayCopy from \"@/components/ArrayCopy.vue\";\nimport ArrayShift from \"@/components/ArrayShift.vue\";\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport ConditionsEditor from \"../State/ConditionsEditor.vue\";\nimport TransitionEditor from \"../State/TransitionEditor.vue\";\nimport TextsEditor from \"../State/TextsEditor.vue\";\nimport VState from \"../State/index.vue\";\n\nimport { defineComponent, PropType, computed, ref, toRaw, watch } from \"vue\";\nimport { State } from \"../types\";\nimport { newState } from \"../utils\";\n\nexport default defineComponent({\n  name: \"BlockEditor\",\n  components: {\n    ArrayCopy,\n    ArrayShift,\n    ConfirmButton,\n    EditorCard,\n    ConditionsEditor,\n    TransitionEditor,\n    VState,\n    TextsEditor,\n  },\n  props: {\n    modelValue: { type: Array as PropType<State[]>, default: undefined },\n  },\n  emits: [\"update:modelValue\"],\n  setup(props, { emit }) {\n    const block = computed({\n      get: () => props.modelValue,\n      set: (b) => emit(\"update:modelValue\", b),\n    });\n    const state = ref(undefined as undefined | State);\n    const glossed = ref(false);\n    watch(block, (block) => (state.value = block?.[block.length - 1]), {\n      immediate: true,\n    });\n\n    function add() {\n      state.value = newState();\n      block.value.push(state.value);\n    }\n    function remove() {\n      if (!state.value) return;\n      block.value.splice(toRaw(block.value).indexOf(toRaw(state.value)), 1);\n      state.value = block.value[block.value.length - 1];\n    }\n    return { add, remove, glossed, state, block };\n  },\n});\n</script>\n","<template>\n  <EditorCard button=\"\" icon=\"tune\" header=\"conditions\">\n    <template v-if=\"conditions\" #header>\n      <btn icon=\"clear\" @click=\"conditions = {}\" />\n    </template>\n    <template #caption>TODO brief explanation</template>\n    <div class=\"row-1 block-editor wrap\">\n      <btn\n        v-for=\"({ entity, tag, color, icon }, i) in tags\"\n        :key=\"entity + '--' + tag\"\n        :class=\"color\"\n        :icon=\"icon\"\n        :text=\"tag\"\n        @click=\"toggle(i)\"\n      />\n    </div>\n  </EditorCard>\n</template>\n\n<script lang=\"ts\">\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport {\n  computed,\n  defineComponent,\n  PropType,\n  inject,\n  ComputedRef,\n  ref,\n  watch,\n} from \"vue\";\nimport { ContextSource, Conditions } from \"../types\";\n\nexport default defineComponent({\n  name: \"ConditionsEditor\",\n  components: { EditorCard },\n  props: {\n    modelValue: { type: Object as PropType<Conditions>, default: undefined },\n  },\n  emits: [\"update:modelValue\"],\n  setup(props, { emit }) {\n    const context = inject(\n      \"contextSource\",\n      {} as ComputedRef<undefined | ContextSource[]>\n    );\n    const conditions = computed({\n      get: () => props.modelValue,\n      set: (c) => emit(\"update:modelValue\", c),\n    });\n    const tags = ref(\n      [] as {\n        tag: string;\n        entity: string;\n        icon: string;\n        color: string;\n        flag?: boolean;\n      }[]\n    );\n    watch(\n      [context, conditions],\n      ([context, conditions]) => {\n        if (!context || !conditions) return;\n        tags.value = context.flatMap(({ entity, tags }, i) =>\n          tags.map((tag) => {\n            const flag = conditions[entity]?.[tag];\n            const icon =\n              flag === undefined ? \"arrow_right\" : flag ? \"send\" : \"lock\";\n\n            return {\n              tag,\n              entity,\n              icon,\n              color: \"colored-dot-\" + i,\n              flag: flag,\n            };\n          })\n        );\n      },\n      { immediate: true, deep: true }\n    );\n    function toggle(index: number) {\n      if (!tags.value) return;\n      const { flag, entity, tag } = tags.value[index];\n      if (flag === undefined) {\n        if (!conditions.value[entity]) conditions.value[entity] = {};\n        conditions.value[entity][tag] = true;\n      } else if (flag) conditions.value[entity][tag] = false;\n      else {\n        delete conditions.value[entity][tag];\n        if (!Object.keys(conditions.value[entity]).length)\n          delete conditions.value[entity];\n      }\n    }\n\n    return { context, conditions, tags, toggle };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.scroll {\n  max-height: 128px;\n}\n</style>\n","\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport {\n  computed,\n  defineComponent,\n  PropType,\n  inject,\n  ComputedRef,\n  ref,\n  watch,\n} from \"vue\";\nimport { ContextSource, Conditions } from \"../types\";\n\nexport default defineComponent({\n  name: \"ConditionsEditor\",\n  components: { EditorCard },\n  props: {\n    modelValue: { type: Object as PropType<Conditions>, default: undefined },\n  },\n  emits: [\"update:modelValue\"],\n  setup(props, { emit }) {\n    const context = inject(\n      \"contextSource\",\n      {} as ComputedRef<undefined | ContextSource[]>\n    );\n    const conditions = computed({\n      get: () => props.modelValue,\n      set: (c) => emit(\"update:modelValue\", c),\n    });\n    const tags = ref(\n      [] as {\n        tag: string;\n        entity: string;\n        icon: string;\n        color: string;\n        flag?: boolean;\n      }[]\n    );\n    watch(\n      [context, conditions],\n      ([context, conditions]) => {\n        if (!context || !conditions) return;\n        tags.value = context.flatMap(({ entity, tags }, i) =>\n          tags.map((tag) => {\n            const flag = conditions[entity]?.[tag];\n            const icon =\n              flag === undefined ? \"arrow_right\" : flag ? \"send\" : \"lock\";\n\n            return {\n              tag,\n              entity,\n              icon,\n              color: \"colored-dot-\" + i,\n              flag: flag,\n            };\n          })\n        );\n      },\n      { immediate: true, deep: true }\n    );\n    function toggle(index: number) {\n      if (!tags.value) return;\n      const { flag, entity, tag } = tags.value[index];\n      if (flag === undefined) {\n        if (!conditions.value[entity]) conditions.value[entity] = {};\n        conditions.value[entity][tag] = true;\n      } else if (flag) conditions.value[entity][tag] = false;\n      else {\n        delete conditions.value[entity][tag];\n        if (!Object.keys(conditions.value[entity]).length)\n          delete conditions.value[entity];\n      }\n    }\n\n    return { context, conditions, tags, toggle };\n  },\n});\n","import { render } from \"./ConditionsEditor.vue?vue&type=template&id=8572926c&scoped=true\"\nimport script from \"./ConditionsEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./ConditionsEditor.vue?vue&type=script&lang=ts\"\n\nimport \"./ConditionsEditor.vue?vue&type=style&index=0&id=8572926c&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-8572926c\"\n\nexport default script","<template>\n  <EditorCard button=\"\" icon=\"alt_route\" header=\"transition\">\n    <template #header>\n      <div class=\"row\">\n        <btn icon=\"block\" :is-on=\"mode === 0\" @click=\"mode = 0\" />\n        <btn icon=\"arrow_forward\" :is-on=\"mode === 1\" @click=\"mode = 1\" />\n        <btn icon=\"star_outline\" :is-on=\"mode === 2\" @click=\"mode = 2\" />\n      </div>\n    </template>\n    <div v-if=\"mode === 2\" class=\"row-1 wrap block-editor\">\n      <div v-for=\"(s, i) in states\" :key=\"i\" class=\"row\">\n        <btn icon=\"check\" :is-on=\"transition.includes(i)\" @click=\"toggle(i)\" />\n        <VState :state=\"s\" />\n      </div>\n    </div>\n  </EditorCard>\n</template>\n\n<script lang=\"ts\">\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport VState from \"./index.vue\";\n\nimport { computed, defineComponent, PropType } from \"vue\";\nimport { Transition, State } from \"../types\";\n\nexport default defineComponent({\n  name: \"TransitionEditor\",\n  components: { EditorCard, VState },\n  props: {\n    modelValue: {\n      type: [Array, String],\n      default: undefined,\n    },\n    states: { type: Array as PropType<State[]>, default: () => [] },\n  },\n  emits: [\"update:modelValue\"],\n  setup(props, { emit }) {\n    const transition = computed({\n      get: () => props.modelValue as Transition,\n      set: (t) => emit(\"update:modelValue\", t),\n    });\n    const mode = computed({\n      get: () => (transition.value ? (transition.value === \"next\" ? 1 : 2) : 0),\n      set: (m) => (transition.value = m ? (m === 1 ? \"next\" : []) : undefined),\n    });\n\n    function toggle(stateIndex: number) {\n      if (!Array.isArray(transition.value)) return;\n      const index = transition.value.indexOf(stateIndex);\n      if (index < 0) transition.value.push(stateIndex);\n      else transition.value.splice(index, 1);\n    }\n    return { transition, mode, toggle };\n  },\n});\n</script>\n","\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport VState from \"./index.vue\";\n\nimport { computed, defineComponent, PropType } from \"vue\";\nimport { Transition, State } from \"../types\";\n\nexport default defineComponent({\n  name: \"TransitionEditor\",\n  components: { EditorCard, VState },\n  props: {\n    modelValue: {\n      type: [Array, String],\n      default: undefined,\n    },\n    states: { type: Array as PropType<State[]>, default: () => [] },\n  },\n  emits: [\"update:modelValue\"],\n  setup(props, { emit }) {\n    const transition = computed({\n      get: () => props.modelValue as Transition,\n      set: (t) => emit(\"update:modelValue\", t),\n    });\n    const mode = computed({\n      get: () => (transition.value ? (transition.value === \"next\" ? 1 : 2) : 0),\n      set: (m) => (transition.value = m ? (m === 1 ? \"next\" : []) : undefined),\n    });\n\n    function toggle(stateIndex: number) {\n      if (!Array.isArray(transition.value)) return;\n      const index = transition.value.indexOf(stateIndex);\n      if (index < 0) transition.value.push(stateIndex);\n      else transition.value.splice(index, 1);\n    }\n    return { transition, mode, toggle };\n  },\n});\n","import { render } from \"./TransitionEditor.vue?vue&type=template&id=2959c58c\"\nimport script from \"./TransitionEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./TransitionEditor.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <EditorCard icon=\"format_color_text\" header=\"texts\" @action=\"add\">\n    <div class=\"col\">\n      <div v-for=\"(t, i) in texts\" :key=\"i\" class=\"row\">\n        <btn icon=\"palette\" @click=\"toggle(i)\" />\n        <div class=\"row\" :class=\"colors[i]\">\n          <input v-model=\"t.plain\" type=\"text\" placeholder=\"plain\" />\n          <input\n            v-model=\"t.ipa\"\n            class=\"text-ipa\"\n            type=\"text\"\n            placeholder=\"ipa\"\n          />\n          <input v-model=\"t.gloss\" type=\"text\" placeholder=\"gloss\" />\n        </div>\n        <btn icon=\"clear\" @click=\"remove(i)\" />\n      </div>\n    </div>\n  </EditorCard>\n</template>\n\n<script lang=\"ts\">\nimport EditorCard from \"@/components/EditorCard.vue\";\n\nimport { computed, defineComponent, PropType, inject, Ref } from \"vue\";\nimport { Text, Context } from \"../types\";\n\nexport default defineComponent({\n  name: \"TextsEditor\",\n  components: { EditorCard },\n  props: {\n    modelValue: { type: Array as PropType<Text[]>, default: undefined },\n  },\n  emits: [\"update:modelValue\"],\n  setup(props, { emit }) {\n    const context = inject(\"context\", {} as Ref<Context>);\n    const entities = computed(() => Object.keys(context.value));\n\n    const texts = computed({\n      get: () => props.modelValue,\n      set: (t) => emit(\"update:modelValue\", t),\n    });\n    const colors = computed(() =>\n      texts.value\n        ?.map(({ entity }) => entities.value.indexOf(entity ?? \"\"))\n        .map((i) => \"colored-\" + i)\n    );\n\n    function add() {\n      texts.value.push({ plain: \"\" });\n    }\n    function remove(i: number) {\n      texts.value.splice(i, 1);\n    }\n    function toggle(i: number) {\n      const text = texts.value[i];\n      const e = entities.value.indexOf(text.entity ?? \"\");\n      text.entity = entities.value[e + 1];\n    }\n\n    return { texts, colors, add, remove, toggle };\n  },\n});\n</script>\n","\nimport EditorCard from \"@/components/EditorCard.vue\";\n\nimport { computed, defineComponent, PropType, inject, Ref } from \"vue\";\nimport { Text, Context } from \"../types\";\n\nexport default defineComponent({\n  name: \"TextsEditor\",\n  components: { EditorCard },\n  props: {\n    modelValue: { type: Array as PropType<Text[]>, default: undefined },\n  },\n  emits: [\"update:modelValue\"],\n  setup(props, { emit }) {\n    const context = inject(\"context\", {} as Ref<Context>);\n    const entities = computed(() => Object.keys(context.value));\n\n    const texts = computed({\n      get: () => props.modelValue,\n      set: (t) => emit(\"update:modelValue\", t),\n    });\n    const colors = computed(() =>\n      texts.value\n        ?.map(({ entity }) => entities.value.indexOf(entity ?? \"\"))\n        .map((i) => \"colored-\" + i)\n    );\n\n    function add() {\n      texts.value.push({ plain: \"\" });\n    }\n    function remove(i: number) {\n      texts.value.splice(i, 1);\n    }\n    function toggle(i: number) {\n      const text = texts.value[i];\n      const e = entities.value.indexOf(text.entity ?? \"\");\n      text.entity = entities.value[e + 1];\n    }\n\n    return { texts, colors, add, remove, toggle };\n  },\n});\n","import { render } from \"./TextsEditor.vue?vue&type=template&id=42bab2ee\"\nimport script from \"./TextsEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./TextsEditor.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\nimport ConfirmButton from \"@/components/ConfirmButton.vue\";\nimport ArrayCopy from \"@/components/ArrayCopy.vue\";\nimport ArrayShift from \"@/components/ArrayShift.vue\";\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport ConditionsEditor from \"../State/ConditionsEditor.vue\";\nimport TransitionEditor from \"../State/TransitionEditor.vue\";\nimport TextsEditor from \"../State/TextsEditor.vue\";\nimport VState from \"../State/index.vue\";\n\nimport { defineComponent, PropType, computed, ref, toRaw, watch } from \"vue\";\nimport { State } from \"../types\";\nimport { newState } from \"../utils\";\n\nexport default defineComponent({\n  name: \"BlockEditor\",\n  components: {\n    ArrayCopy,\n    ArrayShift,\n    ConfirmButton,\n    EditorCard,\n    ConditionsEditor,\n    TransitionEditor,\n    VState,\n    TextsEditor,\n  },\n  props: {\n    modelValue: { type: Array as PropType<State[]>, default: undefined },\n  },\n  emits: [\"update:modelValue\"],\n  setup(props, { emit }) {\n    const block = computed({\n      get: () => props.modelValue,\n      set: (b) => emit(\"update:modelValue\", b),\n    });\n    const state = ref(undefined as undefined | State);\n    const glossed = ref(false);\n    watch(block, (block) => (state.value = block?.[block.length - 1]), {\n      immediate: true,\n    });\n\n    function add() {\n      state.value = newState();\n      block.value.push(state.value);\n    }\n    function remove() {\n      if (!state.value) return;\n      block.value.splice(toRaw(block.value).indexOf(toRaw(state.value)), 1);\n      state.value = block.value[block.value.length - 1];\n    }\n    return { add, remove, glossed, state, block };\n  },\n});\n","import { render } from \"./Editor.vue?vue&type=template&id=0d110b6b\"\nimport script from \"./Editor.vue?vue&type=script&lang=ts\"\nexport * from \"./Editor.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","import { watch, ref, Ref } from \"vue\";\n\ntype Options = {\n  defaultFile: unknown;\n  storage: string;\n  filename: string | (() => string);\n};\n\nexport const config: Options = {\n  defaultFile: {},\n  storage: \"\",\n  filename: \"\",\n};\n\nexport const file = ref();\n\nexport function resetFile() {\n  file.value = JSON.parse(JSON.stringify(config.defaultFile));\n}\n\nexport function saveFile() {\n  localStorage[config.storage] = JSON.stringify(file.value);\n}\n\nexport function setupEditor<T>(options: Partial<Options>) {\n  Object.assign(config, options);\n  try {\n    file.value = JSON.parse(localStorage[config.storage]);\n  } catch {\n    resetFile();\n  }\n  watch(file, saveFile, { deep: true });\n\n  return file as Ref<T>;\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar nativeJoin = [].join;\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar STRICT_METHOD = arrayMethodIsStrict('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.es/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {\n  join: function join(separator) {\n    return nativeJoin.call(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","'use strict';\nvar isArray = require('../internals/is-array');\nvar toLength = require('../internals/to-length');\nvar bind = require('../internals/function-bind-context');\n\n// `FlattenIntoArray` abstract operation\n// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray\nvar flattenIntoArray = function (target, original, source, sourceLen, start, depth, mapper, thisArg) {\n  var targetIndex = start;\n  var sourceIndex = 0;\n  var mapFn = mapper ? bind(mapper, thisArg, 3) : false;\n  var element;\n\n  while (sourceIndex < sourceLen) {\n    if (sourceIndex in source) {\n      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];\n\n      if (depth > 0 && isArray(element)) {\n        targetIndex = flattenIntoArray(target, original, element, toLength(element.length), targetIndex, depth - 1) - 1;\n      } else {\n        if (targetIndex >= 0x1FFFFFFFFFFFFF) throw TypeError('Exceed the acceptable array length');\n        target[targetIndex] = element;\n      }\n\n      targetIndex++;\n    }\n    sourceIndex++;\n  }\n  return targetIndex;\n};\n\nmodule.exports = flattenIntoArray;\n","'use strict';\nvar $ = require('../internals/export');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toInteger = require('../internals/to-integer');\nvar toLength = require('../internals/to-length');\nvar toObject = require('../internals/to-object');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar createProperty = require('../internals/create-property');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('splice');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('splice', { ACCESSORS: true, 0: 0, 1: 2 });\n\nvar max = Math.max;\nvar min = Math.min;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_LENGTH_EXCEEDED = 'Maximum allowed length exceeded';\n\n// `Array.prototype.splice` method\n// https://tc39.es/ecma262/#sec-array.prototype.splice\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  splice: function splice(start, deleteCount /* , ...items */) {\n    var O = toObject(this);\n    var len = toLength(O.length);\n    var actualStart = toAbsoluteIndex(start, len);\n    var argumentsLength = arguments.length;\n    var insertCount, actualDeleteCount, A, k, from, to;\n    if (argumentsLength === 0) {\n      insertCount = actualDeleteCount = 0;\n    } else if (argumentsLength === 1) {\n      insertCount = 0;\n      actualDeleteCount = len - actualStart;\n    } else {\n      insertCount = argumentsLength - 2;\n      actualDeleteCount = min(max(toInteger(deleteCount), 0), len - actualStart);\n    }\n    if (len + insertCount - actualDeleteCount > MAX_SAFE_INTEGER) {\n      throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);\n    }\n    A = arraySpeciesCreate(O, actualDeleteCount);\n    for (k = 0; k < actualDeleteCount; k++) {\n      from = actualStart + k;\n      if (from in O) createProperty(A, k, O[from]);\n    }\n    A.length = actualDeleteCount;\n    if (insertCount < actualDeleteCount) {\n      for (k = actualStart; k < len - actualDeleteCount; k++) {\n        from = k + actualDeleteCount;\n        to = k + insertCount;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n      for (k = len; k > len - actualDeleteCount + insertCount; k--) delete O[k - 1];\n    } else if (insertCount > actualDeleteCount) {\n      for (k = len - actualDeleteCount; k > actualStart; k--) {\n        from = k + actualDeleteCount - 1;\n        to = k + insertCount - 1;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n    }\n    for (k = 0; k < insertCount; k++) {\n      O[k + actualStart] = arguments[k + 2];\n    }\n    O.length = len - actualDeleteCount + insertCount;\n    return A;\n  }\n});\n","<template>\n  <div class=\"display row\" :class=\"{ glossed: canGloss }\">\n    <div class=\"segments\">\n      <p v-for=\"(type, i) in types\" :key=\"type\" :class=\"'text-' + type\">\n        <span v-for=\"(text, j) in texts[i]\" :key=\"j\" :class=\"textColors[j]\">\n          {{ text }}\n        </span>\n      </p>\n    </div>\n    <div class=\"row dashes\">\n      <p v-for=\"(c, i) in dashColors\" :key=\"i\" :class=\"c\" />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, inject, PropType, Ref, watch } from \"vue\";\nimport { Context, State } from \"../types\";\n\nexport default defineComponent({\n  name: \"State\",\n  props: {\n    state: { type: Object as PropType<State>, default: () => ({}) },\n    glossed: { type: Boolean, default: false },\n  },\n  emits: [\"text\"],\n  setup(props, { emit }) {\n    const context = inject(\"context\", {} as Ref<Context>);\n    const entities = computed(() => Object.keys(context.value));\n    const canGloss = computed(\n      () =>\n        props.glossed &&\n        props.state.texts.some(({ ipa, gloss }) => ipa || gloss)\n    );\n\n    const types = computed<(\"plain\" | \"ipa\" | \"gloss\")[]>(() =>\n      canGloss.value ? [\"ipa\", \"gloss\"] : [\"plain\"]\n    );\n    const texts = computed(() =>\n      types.value.map((type) => props.state.texts?.map((text) => text[type]))\n    );\n    watch(\n      texts,\n      (texts) => {\n        if (!texts) return;\n        const lines = texts.map((t) => t?.join(\"\"));\n        const text = lines.length === 1 ? lines[0] : lines.join(\"\\n\");\n        emit(\"text\", text);\n      },\n      { immediate: true, deep: true }\n    );\n\n    const textColors = computed(() =>\n      props.state.texts\n        .map(({ entity }) => entity ?? \"\")\n        .map((e) => entities.value.indexOf(e))\n        .map((i) => \"colored-\" + i)\n    );\n    const dashColors = computed(() =>\n      props.state.transition && props.state.conditions\n        ? Object.entries(props.state.conditions)\n            .filter(([, tags]) => Object.values(tags).some((flag) => flag))\n            .map(([entity]) => entities.value.indexOf(entity))\n            .map((i) => \"colored-back-\" + i)\n        : []\n    );\n\n    return { types, texts, canGloss, textColors, dashColors };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.display {\n  height: map-get($button-height, \"small\");\n  position: relative;\n  &.glossed {\n    height: map-get($button-height, \"normal\") + map-get($margins, \"normal\");\n  }\n}\n.segments {\n  display: flex;\n  flex-direction: column;\n  p {\n    display: flex;\n    place-content: center;\n  }\n}\n.dashes {\n  overflow: hidden;\n  border-radius: 0 0 $border-radius $border-radius;\n  height: $border-radius;\n  width: 100%;\n  left: 0;\n  justify-content: center;\n  position: absolute;\n  bottom: 0;\n  > * {\n    height: 100%;\n    width: 4 * $border-radius;\n  }\n}\n</style>\n","\nimport { computed, defineComponent, inject, PropType, Ref, watch } from \"vue\";\nimport { Context, State } from \"../types\";\n\nexport default defineComponent({\n  name: \"State\",\n  props: {\n    state: { type: Object as PropType<State>, default: () => ({}) },\n    glossed: { type: Boolean, default: false },\n  },\n  emits: [\"text\"],\n  setup(props, { emit }) {\n    const context = inject(\"context\", {} as Ref<Context>);\n    const entities = computed(() => Object.keys(context.value));\n    const canGloss = computed(\n      () =>\n        props.glossed &&\n        props.state.texts.some(({ ipa, gloss }) => ipa || gloss)\n    );\n\n    const types = computed<(\"plain\" | \"ipa\" | \"gloss\")[]>(() =>\n      canGloss.value ? [\"ipa\", \"gloss\"] : [\"plain\"]\n    );\n    const texts = computed(() =>\n      types.value.map((type) => props.state.texts?.map((text) => text[type]))\n    );\n    watch(\n      texts,\n      (texts) => {\n        if (!texts) return;\n        const lines = texts.map((t) => t?.join(\"\"));\n        const text = lines.length === 1 ? lines[0] : lines.join(\"\\n\");\n        emit(\"text\", text);\n      },\n      { immediate: true, deep: true }\n    );\n\n    const textColors = computed(() =>\n      props.state.texts\n        .map(({ entity }) => entity ?? \"\")\n        .map((e) => entities.value.indexOf(e))\n        .map((i) => \"colored-\" + i)\n    );\n    const dashColors = computed(() =>\n      props.state.transition && props.state.conditions\n        ? Object.entries(props.state.conditions)\n            .filter(([, tags]) => Object.values(tags).some((flag) => flag))\n            .map(([entity]) => entities.value.indexOf(entity))\n            .map((i) => \"colored-back-\" + i)\n        : []\n    );\n\n    return { types, texts, canGloss, textColors, dashColors };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=661aca89&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=661aca89&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-661aca89\"\n\nexport default script","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./EditorCard.vue?vue&type=style&index=0&id=245b6f20&lang=scss&scoped=true\"","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.es/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","<template>\n  <btn icon=\"add_box\" @click=\"copy\" />\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, toRaw, computed } from \"vue\";\n\nexport default defineComponent({\n  props: {\n    modelValue: { type: Array, default: () => undefined },\n    item: { type: Object, default: undefined },\n  },\n  emits: [\"update:modelValue\", \"update:item\"],\n  setup(props, { emit }) {\n    const array = computed({\n      get: () => props.modelValue,\n      set: (a) => emit(\"update:modelValue\", a),\n    });\n    function copy() {\n      const copy = JSON.parse(JSON.stringify(toRaw(props.item)));\n      array.value.push(copy);\n      emit(\"update:item\", copy);\n    }\n    return { copy };\n  },\n});\n</script>\n","\nimport { defineComponent, toRaw, computed } from \"vue\";\n\nexport default defineComponent({\n  props: {\n    modelValue: { type: Array, default: () => undefined },\n    item: { type: Object, default: undefined },\n  },\n  emits: [\"update:modelValue\", \"update:item\"],\n  setup(props, { emit }) {\n    const array = computed({\n      get: () => props.modelValue,\n      set: (a) => emit(\"update:modelValue\", a),\n    });\n    function copy() {\n      const copy = JSON.parse(JSON.stringify(toRaw(props.item)));\n      array.value.push(copy);\n      emit(\"update:item\", copy);\n    }\n    return { copy };\n  },\n});\n","import { render } from \"./ArrayCopy.vue?vue&type=template&id=11aebb97\"\nimport script from \"./ArrayCopy.vue?vue&type=script&lang=ts\"\nexport * from \"./ArrayCopy.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ConditionsEditor.vue?vue&type=style&index=0&id=8572926c&lang=scss&scoped=true\""],"sourceRoot":""}