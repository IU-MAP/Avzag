{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.object.values.js","webpack:///./node_modules/core-js/modules/es.array.reduce.js","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack:///./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack:///./src/Phrasebook/State/index.vue?4761","webpack:///./src/Phrasebook/PhraseCard.vue?5922","webpack:///./src/Phrasebook/index.vue","webpack:///./src/Phrasebook/PhraseCard.vue","webpack:///./src/Phrasebook/PhraseCard.vue?0f23","webpack:///./src/Phrasebook/PhraseCard.vue?dc76","webpack:///./src/Phrasebook/main.ts","webpack:///./src/Phrasebook/index.vue?dcc3","webpack:///./src/Phrasebook/index.vue?b05c","webpack:///./node_modules/core-js/modules/es.array.some.js","webpack:///./src/Phrasebook/Context/index.vue?1f76","webpack:///./src/Phrasebook/Context/index.vue","webpack:///./src/Phrasebook/Context/index.vue?ec8a","webpack:///./src/Phrasebook/Context/index.vue?3f4e","webpack:///./src/Phrasebook/Block/index.vue","webpack:///./src/Phrasebook/Block/index.vue?471d","webpack:///./src/Phrasebook/Block/index.vue?892b","webpack:///./src/Phrasebook/utils.ts","webpack:///./src/Phrasebook/Block/index.vue?ba49","webpack:///./node_modules/core-js/modules/es.array.concat.js","webpack:///./node_modules/core-js/modules/es.array.join.js","webpack:///./src/Phrasebook/index.vue?ac6f","webpack:///./src/Phrasebook/State/index.vue","webpack:///./src/Phrasebook/State/index.vue?b225","webpack:///./src/Phrasebook/State/index.vue?b39a","webpack:///./node_modules/core-js/modules/es.object.keys.js","webpack:///./node_modules/core-js/modules/es.array.index-of.js","webpack:///./node_modules/core-js/internals/array-reduce.js","webpack:///./src/components/Notes/index.vue","webpack:///./src/components/Notes/index.vue?4c77","webpack:///./src/components/Notes/index.vue?7695","webpack:///./src/audio-player.ts"],"names":["$","$values","values","target","stat","O","$reduce","left","arrayMethodIsStrict","arrayMethodUsesToLength","CHROME_VERSION","IS_NODE","STRICT_METHOD","USES_TO_LENGTH","1","CHROME_BUG","proto","forced","reduce","callbackfn","this","arguments","length","undefined","_arrayWithoutHoles","arr","Array","isArray","arrayLikeToArray","_iterableToArray","iter","Symbol","iterator","Object","from","_nonIterableSpread","TypeError","_toConsumableArray","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","class","corpus","searching","icon","query","type","placeholder","section","style","select","s","key","id","value","name","phrases","ps","p","text","is-on","phrase","phrasebooks","n","lect","playing","copy","glossed","translation","contextTranslation","blocks","b","i","playbacks","ref","el","push","block","notes","components","Context","Block","Notes","props","String","default","setup","context","filter","state","map","join","navigator","clipboard","writeText","lectRoot","urls","texts","plain","get","set","playback","current","forEach","_u","render","__scopeId","initialize","PhraseCard","immediate","result","index","includes","_section","_phrase","$some","some","any","translated","tags","tag","explicit","condition","conditions","entries","entity","Set","add","translate","d","k","has","disabled","move","$event","VState","Boolean","emits","transition","switchState","nextState","states","indexOf","deep","newState","createContext","source","checkConditions","score","count","flag","findBestState","indexes","candidates","candidate","c","applyConditions","additive","delete","fails","isObject","toObject","toLength","createProperty","arraySpeciesCreate","arrayMethodHasSpeciesSupport","wellKnownSymbol","V8_VERSION","IS_CONCAT_SPREADABLE","MAX_SAFE_INTEGER","MAXIMUM_ALLOWED_INDEX_EXCEEDED","IS_CONCAT_SPREADABLE_SUPPORT","array","concat","SPECIES_SUPPORT","isConcatSpreadable","spreadable","FORCED","arg","len","E","A","IndexedObject","toIndexedObject","nativeJoin","ES3_STRINGS","separator","call","canGloss","types","j","textColors","dashColors","emit","entities","keys","ipa","gloss","lines","t","e","nativeKeys","FAILS_ON_PRIMITIVES","it","$indexOf","nativeIndexOf","NEGATIVE_ZERO","ACCESSORS","searchElement","apply","aFunction","createMethod","IS_RIGHT","that","argumentsLength","memo","self","module","exports","right","pieces","display","isWrapped","start","end","toPiece","patterns","slice","split","audio","Audio","queue","next","stop","src","play","_id","srcs","pause","ontimeupdate","currentTime","duration","oncanplaythrough","onended","onerror"],"mappings":"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","file":"js/chunk-60fb171c.79be6fe6.js","sourcesContent":["var $ = require('../internals/export');\nvar $values = require('../internals/object-to-array').values;\n\n// `Object.values` method\n// https://tc39.es/ecma262/#sec-object.values\n$({ target: 'Object', stat: true }, {\n  values: function values(O) {\n    return $values(O);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $reduce = require('../internals/array-reduce').left;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\nvar CHROME_VERSION = require('../internals/engine-v8-version');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar STRICT_METHOD = arrayMethodIsStrict('reduce');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('reduce', { 1: 0 });\n// Chrome 80-82 has a critical bug\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1049982\nvar CHROME_BUG = !IS_NODE && CHROME_VERSION > 79 && CHROME_VERSION < 83;\n\n// `Array.prototype.reduce` method\n// https://tc39.es/ecma262/#sec-array.prototype.reduce\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || !USES_TO_LENGTH || CHROME_BUG }, {\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    return $reduce(this, callbackfn, arguments.length, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithoutHoles from \"@babel/runtime/helpers/esm/arrayWithoutHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableSpread from \"@babel/runtime/helpers/esm/nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=661aca89&lang=scss&scoped=true\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PhraseCard.vue?vue&type=style&index=0&id=6cd1d69b&lang=scss&scoped=true\"","<template>\n  <div v-if=\"corpus\" class=\"section col-1\">\n    <div class=\"col-1\">\n      <div class=\"row-1\">\n        <toggle v-model=\"searching\" icon=\"search\" />\n        <input\n          v-if=\"searching\"\n          v-model=\"query\"\n          class=\"flex\"\n          type=\"text\"\n          placeholder=\"Search all phrases...\"\n        />\n        <h2 v-else class=\"col-1 flex\">\n          <select\n            v-model=\"section\"\n            style=\"flex: none\"\n            @change=\"select(section)\"\n          >\n            <option v-for=\"s in corpus\" :key=\"s.id\" :value=\"s\">\n              {{ s.name }}\n            </option>\n          </select>\n        </h2>\n      </div>\n      <div class=\"scroll\">\n        <div v-if=\"searching\" class=\"col\">\n          <div v-for=\"(ps, s) of phrases\" :key=\"s\" class=\"col\">\n            <h2>{{ corpus[s].name }}</h2>\n            <div class=\"col-0\">\n              <btn\n                v-for=\"p in ps\"\n                :key=\"p\"\n                :text=\"corpus[s].phrases[p].name\"\n                :is-on=\"phrase === corpus[s].phrases[p]\"\n                @click=\"select(corpus[s], corpus[s].phrases[p])\"\n              />\n            </div>\n          </div>\n        </div>\n        <div v-else class=\"col-0\">\n          <btn\n            v-for=\"p in phrases\"\n            :key=\"p.id\"\n            :text=\"p.name\"\n            :is-on=\"phrase === p\"\n            @click=\"select(null, p)\"\n          />\n        </div>\n      </div>\n    </div>\n    <div v-if=\"phrase\" :key=\"phrase.id\" class=\"col-1\">\n      <PhraseCard :phrase=\"phrase\" />\n      <PhraseCard\n        v-for=\"(p, n) of phrasebooks\"\n        :key=\"n\"\n        :lect=\"n\"\n        :phrase=\"p[phrase.id]\"\n      />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport PhraseCard from \"./PhraseCard.vue\";\n\nimport { computed, ref, watch, defineComponent, provide } from \"vue\";\n\nimport { corpus, section, phrase, phrasebooks, initialize } from \"./main\";\nimport { Context, CorpusPhrase, CorpusSection } from \"./types\";\nimport { createContext } from \"./utils\";\n\nexport default defineComponent({\n  components: { PhraseCard },\n  setup() {\n    initialize();\n\n    const context = ref({} as Context);\n    watch(phrase, (phrase) => createContext(context, phrase?.context), {\n      immediate: true,\n    });\n\n    provide(\"context\", context);\n\n    const searching = ref(false);\n    const query = ref(\"\");\n\n    const phrases = computed(() =>\n      searching.value\n        ? corpus.value.reduce((result, section, index) => {\n            result[index] = section.phrases\n              .map((phrase, index) => [phrase, index] as [CorpusPhrase, number])\n              .filter(([phrase]) => phrase.name.includes(query.value))\n              .map(([, index]) => index);\n            if (!result[index].length) delete result[index];\n            return result;\n          }, {} as Record<number, number[]>)\n        : section.value?.phrases\n    );\n    function select(_section?: CorpusSection, _phrase?: CorpusPhrase) {\n      if (_section) section.value = _section;\n      phrase.value = _phrase ?? section.value?.phrases[0];\n    }\n\n    return {\n      searching,\n      query,\n      corpus,\n      section,\n      phrase,\n      select,\n      phrases,\n      phrasebooks,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.section {\n  display: grid;\n  grid-template-columns: 288px minmax(0, 1fr);\n  gap: map-get($margins, \"double\");\n  > :first-child {\n    max-height: 640px;\n  }\n}\n@media only screen and (max-width: $mobile-width) {\n  .section {\n    > :first-child {\n      max-height: 320px;\n    }\n    grid-template-columns: 100%;\n  }\n}\n</style>\n","<template>\n  <div v-if=\"phrase\" class=\"col card\">\n    <div v-if=\"lect\" class=\"row small wrap\" style=\"width: 100%\">\n      <h2 class=\"flex\">{{ lect }}</h2>\n      <div class=\"row\">\n        <toggle v-model=\"playing\" icon=\"play_arrow\" />\n        <btn icon=\"content_copy\" @click=\"copy\" />\n        <toggle v-model=\"glossed\" icon=\"layers\" />\n      </div>\n    </div>\n    <Context :translation=\"contextTranslation\" :blocks=\"blocks\" />\n    <div class=\"row wrap flex\">\n      <div v-for=\"(b, i) in phrase.blocks\" :key=\"i\" class=\"blocks row\">\n        <p class=\"playback\" :style=\"{ width: playbacks[i] + '%' }\" />\n        <Block :ref=\"(el) => blocks.push(el)\" :block=\"b\" :glossed=\"glossed\" />\n      </div>\n    </div>\n    <Notes class=\"text-caption\" :notes=\"phrase.notes\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport Context from \"./Context/index.vue\";\nimport Block from \"./Block/index.vue\";\nimport Notes from \"@/components/Notes/index.vue\";\n\nimport {\n  computed,\n  defineComponent,\n  onBeforeUpdate,\n  PropType,\n  reactive,\n  ref,\n  watch,\n} from \"vue\";\n\nimport { Phrase, VBlock } from \"./types\";\nimport { root } from \"@/store\";\nimport * as player from \"@/audio-player\";\n\nexport default defineComponent({\n  components: { Context, Block, Notes },\n  props: {\n    lect: { type: String, default: \"\" },\n    phrase: { type: Object as PropType<Phrase>, default: undefined },\n  },\n  setup(props) {\n    const glossed = ref(false);\n    const contextTranslation = computed(() =>\n      props.lect ? props.phrase.context : undefined\n    );\n\n    onBeforeUpdate(() => (blocks.length = 0));\n    const blocks = reactive<VBlock[]>([]);\n    const text = computed(() =>\n      blocks\n        .filter(({ state }) => state)\n        .map(({ text }) => text)\n        .join(\" \")\n    );\n    function copy() {\n      navigator.clipboard.writeText(text.value);\n    }\n\n    const lectRoot = computed(() => root + props.lect + \"/phrasebook/\");\n    const urls = computed(() =>\n      blocks\n        .map(({ state }) => state?.texts.map(({ plain }) => plain))\n        .map((p) => lectRoot.value + p?.join(\"\") + \".mp3\")\n    );\n\n    const playing = computed({\n      get: () => player.playing.value && player.id.value === props.lect,\n      set: (p) => {\n        if (p) player.play(props.lect, ...urls.value);\n        else player.stop();\n      },\n    });\n\n    const playbacks = ref([] as number[]);\n    watch(\n      [player.playback, player.current, playing],\n      ([playback, current, playing]) => {\n        urls.value.forEach(\n          (_u, i) =>\n            (playbacks.value[i] = playing && i === current ? playback * 100 : 0)\n        );\n      }\n    );\n\n    return {\n      glossed,\n      blocks,\n      copy,\n      contextTranslation,\n      urls,\n      playing,\n      playbacks,\n      playback: player.playback,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.card {\n  align-items: flex-start;\n}\n.blocks {\n  position: relative;\n}\n.playback {\n  padding: 0;\n  background-color: var(--color-text);\n  border-radius: $border-radius $border-radius 0 0;\n  height: $border-radius;\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n</style>\n","\nimport Context from \"./Context/index.vue\";\nimport Block from \"./Block/index.vue\";\nimport Notes from \"@/components/Notes/index.vue\";\n\nimport {\n  computed,\n  defineComponent,\n  onBeforeUpdate,\n  PropType,\n  reactive,\n  ref,\n  watch,\n} from \"vue\";\n\nimport { Phrase, VBlock } from \"./types\";\nimport { root } from \"@/store\";\nimport * as player from \"@/audio-player\";\n\nexport default defineComponent({\n  components: { Context, Block, Notes },\n  props: {\n    lect: { type: String, default: \"\" },\n    phrase: { type: Object as PropType<Phrase>, default: undefined },\n  },\n  setup(props) {\n    const glossed = ref(false);\n    const contextTranslation = computed(() =>\n      props.lect ? props.phrase.context : undefined\n    );\n\n    onBeforeUpdate(() => (blocks.length = 0));\n    const blocks = reactive<VBlock[]>([]);\n    const text = computed(() =>\n      blocks\n        .filter(({ state }) => state)\n        .map(({ text }) => text)\n        .join(\" \")\n    );\n    function copy() {\n      navigator.clipboard.writeText(text.value);\n    }\n\n    const lectRoot = computed(() => root + props.lect + \"/phrasebook/\");\n    const urls = computed(() =>\n      blocks\n        .map(({ state }) => state?.texts.map(({ plain }) => plain))\n        .map((p) => lectRoot.value + p?.join(\"\") + \".mp3\")\n    );\n\n    const playing = computed({\n      get: () => player.playing.value && player.id.value === props.lect,\n      set: (p) => {\n        if (p) player.play(props.lect, ...urls.value);\n        else player.stop();\n      },\n    });\n\n    const playbacks = ref([] as number[]);\n    watch(\n      [player.playback, player.current, playing],\n      ([playback, current, playing]) => {\n        urls.value.forEach(\n          (_u, i) =>\n            (playbacks.value[i] = playing && i === current ? playback * 100 : 0)\n        );\n      }\n    );\n\n    return {\n      glossed,\n      blocks,\n      copy,\n      contextTranslation,\n      urls,\n      playing,\n      playbacks,\n      playback: player.playback,\n    };\n  },\n});\n","import { render } from \"./PhraseCard.vue?vue&type=template&id=6cd1d69b&scoped=true\"\nimport script from \"./PhraseCard.vue?vue&type=script&lang=ts\"\nexport * from \"./PhraseCard.vue?vue&type=script&lang=ts\"\n\nimport \"./PhraseCard.vue?vue&type=style&index=0&id=6cd1d69b&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-6cd1d69b\"\n\nexport default script","import { getInitializer, loadJSON, loadLectsJSON } from \"@/store\";\nimport { shallowRef } from \"vue\";\nimport { CorpusPhrase, CorpusSection, Phrasebook } from \"./types\";\n\nexport const corpus = shallowRef<CorpusSection[]>([]);\nexport const phrasebooks = shallowRef<Record<string, Phrasebook>>();\nexport const section = shallowRef<CorpusSection>();\nexport const phrase = shallowRef<CorpusPhrase>();\n\nexport const initialize = getInitializer(async () => {\n  corpus.value = await loadJSON(\"phrasebook\");\n  phrasebooks.value = await loadLectsJSON<Phrasebook>(\"phrasebook\");\n\n  section.value = corpus.value[0];\n  phrase.value = section.value.phrases[0];\n});\n","\nimport PhraseCard from \"./PhraseCard.vue\";\n\nimport { computed, ref, watch, defineComponent, provide } from \"vue\";\n\nimport { corpus, section, phrase, phrasebooks, initialize } from \"./main\";\nimport { Context, CorpusPhrase, CorpusSection } from \"./types\";\nimport { createContext } from \"./utils\";\n\nexport default defineComponent({\n  components: { PhraseCard },\n  setup() {\n    initialize();\n\n    const context = ref({} as Context);\n    watch(phrase, (phrase) => createContext(context, phrase?.context), {\n      immediate: true,\n    });\n\n    provide(\"context\", context);\n\n    const searching = ref(false);\n    const query = ref(\"\");\n\n    const phrases = computed(() =>\n      searching.value\n        ? corpus.value.reduce((result, section, index) => {\n            result[index] = section.phrases\n              .map((phrase, index) => [phrase, index] as [CorpusPhrase, number])\n              .filter(([phrase]) => phrase.name.includes(query.value))\n              .map(([, index]) => index);\n            if (!result[index].length) delete result[index];\n            return result;\n          }, {} as Record<number, number[]>)\n        : section.value?.phrases\n    );\n    function select(_section?: CorpusSection, _phrase?: CorpusPhrase) {\n      if (_section) section.value = _section;\n      phrase.value = _phrase ?? section.value?.phrases[0];\n    }\n\n    return {\n      searching,\n      query,\n      corpus,\n      section,\n      phrase,\n      select,\n      phrases,\n      phrasebooks,\n    };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=262378b6&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=262378b6&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-262378b6\"\n\nexport default script","'use strict';\nvar $ = require('../internals/export');\nvar $some = require('../internals/array-iteration').some;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar STRICT_METHOD = arrayMethodIsStrict('some');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('some');\n\n// `Array.prototype.some` method\n// https://tc39.es/ecma262/#sec-array.prototype.some\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || !USES_TO_LENGTH }, {\n  some: function some(callbackfn /* , thisArg */) {\n    return $some(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=caacf090&lang=scss&scoped=true\"","<template>\n  <div class=\"row text-caption wrap\">\n    <div class=\"icon\">info</div>\n    <template v-if=\"any\">\n      <template v-for=\"(tags, i) of translated\" :key=\"i\">\n        <template v-if=\"tags.length\" class=\"row-0 wrap\">\n          <p\n            v-for=\"tag in tags\"\n            :key=\"tag + '--' + i\"\n            :class=\"'colored-dot-' + i\"\n          >\n            {{ tag }}\n          </p>\n        </template>\n      </template>\n    </template>\n    <template v-else>…</template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, inject, Ref, PropType } from \"vue\";\nimport { Context, ContextTranslation, VBlock } from \"../types\";\n\nexport default defineComponent({\n  name: \"Context\",\n  props: {\n    translation: {\n      type: Object as PropType<ContextTranslation>,\n      default: () => ({}),\n    },\n    blocks: { type: Array as PropType<VBlock[]>, default: () => [] },\n  },\n  setup(props) {\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    const explicit = computed(() => {\n      const result = {} as Context;\n      for (const { state } of props.blocks) {\n        const condition = state?.conditions;\n        if (!condition) continue;\n        Object.entries(condition).forEach(([entity, tags]) =>\n          Object.entries(tags).forEach(([tag]) => {\n            if (!result[entity]) result[entity] = new Set();\n            result[entity].add(tag);\n          })\n        );\n      }\n      return result;\n    });\n\n    function translate(d: undefined | Record<string, string>, k: string) {\n      return d?.[k] || k;\n    }\n    const translated = computed(() =>\n      Object.entries(context.value).map(([entity, tags]) =>\n        [...tags]\n          .filter((tag) => !explicit.value[entity]?.has(tag))\n          .map((tag) => translate(props.translation?.[entity], tag))\n      )\n    );\n    const any = computed(() => translated.value.some((tags) => tags?.length));\n\n    return { translated, any };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\ndiv.icon {\n  font-size: map-get($font-sizes, \"small\");\n}\np:not(:last-child)::after {\n  content: \",\";\n}\n</style>\n","\nimport { computed, defineComponent, inject, Ref, PropType } from \"vue\";\nimport { Context, ContextTranslation, VBlock } from \"../types\";\n\nexport default defineComponent({\n  name: \"Context\",\n  props: {\n    translation: {\n      type: Object as PropType<ContextTranslation>,\n      default: () => ({}),\n    },\n    blocks: { type: Array as PropType<VBlock[]>, default: () => [] },\n  },\n  setup(props) {\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    const explicit = computed(() => {\n      const result = {} as Context;\n      for (const { state } of props.blocks) {\n        const condition = state?.conditions;\n        if (!condition) continue;\n        Object.entries(condition).forEach(([entity, tags]) =>\n          Object.entries(tags).forEach(([tag]) => {\n            if (!result[entity]) result[entity] = new Set();\n            result[entity].add(tag);\n          })\n        );\n      }\n      return result;\n    });\n\n    function translate(d: undefined | Record<string, string>, k: string) {\n      return d?.[k] || k;\n    }\n    const translated = computed(() =>\n      Object.entries(context.value).map(([entity, tags]) =>\n        [...tags]\n          .filter((tag) => !explicit.value[entity]?.has(tag))\n          .map((tag) => translate(props.translation?.[entity], tag))\n      )\n    );\n    const any = computed(() => translated.value.some((tags) => tags?.length));\n\n    return { translated, any };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=caacf090&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=caacf090&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-caacf090\"\n\nexport default script","<template>\n  <button\n    v-show=\"text\"\n    v-if=\"state\"\n    class=\"small\"\n    :class=\"{ disabled, glossed }\"\n    @click=\"move\"\n  >\n    <VState :glossed=\"glossed\" :state=\"state\" @text=\"text = $event\" />\n  </button>\n</template>\n\n<script lang=\"ts\">\nimport VState from \"../State/index.vue\";\n\nimport {\n  computed,\n  defineComponent,\n  inject,\n  PropType,\n  ref,\n  Ref,\n  toRaw,\n  watch,\n} from \"vue\";\nimport { Context, State } from \"../types\";\nimport { applyConditions, findBestState, checkConditions } from \"../utils\";\n\nexport default defineComponent({\n  name: \"Block\",\n  components: { VState },\n  props: {\n    block: { type: Array as PropType<State[]>, default: undefined },\n    glossed: Boolean,\n  },\n  emits: [\"update:modelValue\"],\n  setup(props) {\n    const state = ref<State>();\n    const disabled = computed(() => !state.value?.transition);\n    const text = ref(\"\");\n\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    function switchState(nextState: undefined | State) {\n      if (toRaw(nextState) === toRaw(state.value)) return;\n      applyConditions(context, state.value?.conditions, false);\n      applyConditions(context, nextState?.conditions, true);\n      state.value = nextState;\n    }\n    watch(\n      context,\n      (context) => {\n        const nextState = findBestState(undefined, props.block, context);\n        switchState(nextState);\n      },\n      { immediate: true, deep: true }\n    );\n\n    function move() {\n      if (disabled.value) return;\n      const transition = state.value?.transition;\n      const states = props.block;\n      let nextState;\n\n      if (transition === \"next\") {\n        const i = state.value ? states.indexOf(toRaw(state.value)) : -1;\n        nextState = states[(i + 1) % states.length];\n      } else if (transition)\n        nextState = findBestState(transition, states, context.value);\n\n      switchState(nextState);\n      if (checkConditions(nextState?.conditions, context.value)[0] < 0)\n        state.value = undefined;\n    }\n\n    return {\n      move,\n      state,\n      disabled,\n      text,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\nbutton {\n  height: fit-content;\n  padding: 0;\n  &.disabled {\n    padding: 0;\n    background-color: transparent;\n    &:hover,\n    &:active {\n      background-color: transparent;\n    }\n    cursor: default;\n  }\n  &:not(.disabled) > * {\n    padding: 0 map-get($margins, \"normal\");\n  }\n}\n</style>\n","\nimport VState from \"../State/index.vue\";\n\nimport {\n  computed,\n  defineComponent,\n  inject,\n  PropType,\n  ref,\n  Ref,\n  toRaw,\n  watch,\n} from \"vue\";\nimport { Context, State } from \"../types\";\nimport { applyConditions, findBestState, checkConditions } from \"../utils\";\n\nexport default defineComponent({\n  name: \"Block\",\n  components: { VState },\n  props: {\n    block: { type: Array as PropType<State[]>, default: undefined },\n    glossed: Boolean,\n  },\n  emits: [\"update:modelValue\"],\n  setup(props) {\n    const state = ref<State>();\n    const disabled = computed(() => !state.value?.transition);\n    const text = ref(\"\");\n\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    function switchState(nextState: undefined | State) {\n      if (toRaw(nextState) === toRaw(state.value)) return;\n      applyConditions(context, state.value?.conditions, false);\n      applyConditions(context, nextState?.conditions, true);\n      state.value = nextState;\n    }\n    watch(\n      context,\n      (context) => {\n        const nextState = findBestState(undefined, props.block, context);\n        switchState(nextState);\n      },\n      { immediate: true, deep: true }\n    );\n\n    function move() {\n      if (disabled.value) return;\n      const transition = state.value?.transition;\n      const states = props.block;\n      let nextState;\n\n      if (transition === \"next\") {\n        const i = state.value ? states.indexOf(toRaw(state.value)) : -1;\n        nextState = states[(i + 1) % states.length];\n      } else if (transition)\n        nextState = findBestState(transition, states, context.value);\n\n      switchState(nextState);\n      if (checkConditions(nextState?.conditions, context.value)[0] < 0)\n        state.value = undefined;\n    }\n\n    return {\n      move,\n      state,\n      disabled,\n      text,\n    };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=354bd589&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=354bd589&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-354bd589\"\n\nexport default script","import { Ref } from \"vue\";\nimport { Context, State, Conditions, ContextSource } from \"./types\";\n\nexport function newState() {\n  return {\n    texts: [{ plain: \"new state\" }],\n    transition: \"next\",\n    conditions: {},\n  } as State;\n}\n\nexport function createContext(context: Ref<Context>, source?: ContextSource[]) {\n  if (!source) return;\n  context.value = {};\n  source.forEach(({ entity }) => (context.value[entity] = new Set()));\n}\n\nexport function checkConditions(\n  conditions: undefined | Conditions,\n  context: Context\n): [number, number] {\n  if (!conditions) return [1, 0];\n  let score = 0;\n  let count = 0;\n  for (const [entity, tags] of Object.entries(conditions))\n    for (const [tag, flag] of Object.entries(tags)) {\n      const has = context[entity]?.has(tag);\n      if (!flag && !has) return [-1, 0];\n      if (has) score += 1;\n      count += 1;\n    }\n  return [score / (count || 1), count];\n}\n\nexport function findBestState(\n  indexes: undefined | number[],\n  states: State[],\n  context: Context\n): undefined | State {\n  let state;\n  let score = -1;\n  let count = 0;\n\n  const candidates = indexes?.map((i) => states[i]) ?? states;\n  candidates.forEach((candidate) => {\n    const [s, c] = checkConditions(candidate.conditions, context);\n    if (score === 1 ? s === 1 && c > count : s > score) {\n      state = candidate;\n      score = s;\n      count = c;\n    }\n  });\n  return state;\n}\n\nexport function applyConditions(\n  context: Ref<Context>,\n  conditions: undefined | Conditions,\n  additive: boolean\n) {\n  if (!conditions || !context.value) return;\n  Object.entries(conditions).forEach(([entity, tags]) =>\n    Object.entries(tags).forEach(([tag, flag]) => {\n      const set = context.value[entity];\n      if (!flag || !set) return;\n      if (additive) set.add(tag);\n      else set.delete(tag);\n    })\n  );\n}\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=354bd589&lang=scss&scoped=true\"","'use strict';\nvar $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isArray = require('../internals/is-array');\nvar isObject = require('../internals/is-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar createProperty = require('../internals/create-property');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar IS_CONCAT_SPREADABLE = wellKnownSymbol('isConcatSpreadable');\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_INDEX_EXCEEDED = 'Maximum allowed index exceeded';\n\n// We can't use this feature detection in V8 since it causes\n// deoptimization and serious performance degradation\n// https://github.com/zloirock/core-js/issues/679\nvar IS_CONCAT_SPREADABLE_SUPPORT = V8_VERSION >= 51 || !fails(function () {\n  var array = [];\n  array[IS_CONCAT_SPREADABLE] = false;\n  return array.concat()[0] !== array;\n});\n\nvar SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('concat');\n\nvar isConcatSpreadable = function (O) {\n  if (!isObject(O)) return false;\n  var spreadable = O[IS_CONCAT_SPREADABLE];\n  return spreadable !== undefined ? !!spreadable : isArray(O);\n};\n\nvar FORCED = !IS_CONCAT_SPREADABLE_SUPPORT || !SPECIES_SUPPORT;\n\n// `Array.prototype.concat` method\n// https://tc39.es/ecma262/#sec-array.prototype.concat\n// with adding support of @@isConcatSpreadable and @@species\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  concat: function concat(arg) { // eslint-disable-line no-unused-vars\n    var O = toObject(this);\n    var A = arraySpeciesCreate(O, 0);\n    var n = 0;\n    var i, k, length, len, E;\n    for (i = -1, length = arguments.length; i < length; i++) {\n      E = i === -1 ? O : arguments[i];\n      if (isConcatSpreadable(E)) {\n        len = toLength(E.length);\n        if (n + len > MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        for (k = 0; k < len; k++, n++) if (k in E) createProperty(A, n, E[k]);\n      } else {\n        if (n >= MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        createProperty(A, n++, E);\n      }\n    }\n    A.length = n;\n    return A;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar nativeJoin = [].join;\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar STRICT_METHOD = arrayMethodIsStrict('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.es/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {\n  join: function join(separator) {\n    return nativeJoin.call(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=262378b6&lang=scss&scoped=true\"","<template>\n  <div class=\"display row\" :class=\"{ glossed: canGloss }\">\n    <div class=\"segments\">\n      <p v-for=\"(type, i) in types\" :key=\"type\" :class=\"'text-' + type\">\n        <span v-for=\"(text, j) in texts[i]\" :key=\"j\" :class=\"textColors[j]\">\n          {{ text }}\n        </span>\n      </p>\n    </div>\n    <div class=\"row dashes\">\n      <p v-for=\"(c, i) in dashColors\" :key=\"i\" :class=\"c\" />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, inject, PropType, Ref, watch } from \"vue\";\nimport { Context, State } from \"../types\";\n\nexport default defineComponent({\n  name: \"State\",\n  props: {\n    state: { type: Object as PropType<State>, default: () => ({}) },\n    glossed: { type: Boolean, default: false },\n  },\n  emits: [\"text\"],\n  setup(props, { emit }) {\n    const context = inject(\"context\", {} as Ref<Context>);\n    const entities = computed(() => Object.keys(context.value));\n    const canGloss = computed(\n      () =>\n        props.glossed &&\n        props.state.texts.some(({ ipa, gloss }) => ipa || gloss)\n    );\n\n    const types = computed<(\"plain\" | \"ipa\" | \"gloss\")[]>(() =>\n      canGloss.value ? [\"ipa\", \"gloss\"] : [\"plain\"]\n    );\n    const texts = computed(() =>\n      types.value.map((type) => props.state.texts?.map((text) => text[type]))\n    );\n    watch(\n      texts,\n      (texts) => {\n        if (!texts) return;\n        const lines = texts.map((t) => t?.join(\"\"));\n        const text = lines.length === 1 ? lines[0] : lines.join(\"\\n\");\n        emit(\"text\", text);\n      },\n      { immediate: true, deep: true }\n    );\n\n    const textColors = computed(() =>\n      props.state.texts\n        .map(({ entity }) => entity ?? \"\")\n        .map((e) => entities.value.indexOf(e))\n        .map((i) => \"colored-\" + i)\n    );\n    const dashColors = computed(() =>\n      props.state.transition && props.state.conditions\n        ? Object.entries(props.state.conditions)\n            .filter(([, tags]) => Object.values(tags).some((flag) => flag))\n            .map(([entity]) => entities.value.indexOf(entity))\n            .map((i) => \"colored-back-\" + i)\n        : []\n    );\n\n    return { types, texts, canGloss, textColors, dashColors };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.display {\n  height: map-get($button-height, \"small\");\n  position: relative;\n  &.glossed {\n    height: map-get($button-height, \"normal\") + map-get($margins, \"normal\");\n  }\n}\n.segments {\n  display: flex;\n  flex-direction: column;\n  p {\n    display: flex;\n    place-content: center;\n  }\n}\n.dashes {\n  overflow: hidden;\n  border-radius: 0 0 $border-radius $border-radius;\n  height: $border-radius;\n  width: 100%;\n  left: 0;\n  justify-content: center;\n  position: absolute;\n  bottom: 0;\n  > * {\n    height: 100%;\n    width: 4 * $border-radius;\n  }\n}\n</style>\n","\nimport { computed, defineComponent, inject, PropType, Ref, watch } from \"vue\";\nimport { Context, State } from \"../types\";\n\nexport default defineComponent({\n  name: \"State\",\n  props: {\n    state: { type: Object as PropType<State>, default: () => ({}) },\n    glossed: { type: Boolean, default: false },\n  },\n  emits: [\"text\"],\n  setup(props, { emit }) {\n    const context = inject(\"context\", {} as Ref<Context>);\n    const entities = computed(() => Object.keys(context.value));\n    const canGloss = computed(\n      () =>\n        props.glossed &&\n        props.state.texts.some(({ ipa, gloss }) => ipa || gloss)\n    );\n\n    const types = computed<(\"plain\" | \"ipa\" | \"gloss\")[]>(() =>\n      canGloss.value ? [\"ipa\", \"gloss\"] : [\"plain\"]\n    );\n    const texts = computed(() =>\n      types.value.map((type) => props.state.texts?.map((text) => text[type]))\n    );\n    watch(\n      texts,\n      (texts) => {\n        if (!texts) return;\n        const lines = texts.map((t) => t?.join(\"\"));\n        const text = lines.length === 1 ? lines[0] : lines.join(\"\\n\");\n        emit(\"text\", text);\n      },\n      { immediate: true, deep: true }\n    );\n\n    const textColors = computed(() =>\n      props.state.texts\n        .map(({ entity }) => entity ?? \"\")\n        .map((e) => entities.value.indexOf(e))\n        .map((i) => \"colored-\" + i)\n    );\n    const dashColors = computed(() =>\n      props.state.transition && props.state.conditions\n        ? Object.entries(props.state.conditions)\n            .filter(([, tags]) => Object.values(tags).some((flag) => flag))\n            .map(([entity]) => entities.value.indexOf(entity))\n            .map((i) => \"colored-back-\" + i)\n        : []\n    );\n\n    return { types, texts, canGloss, textColors, dashColors };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=661aca89&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=661aca89&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-661aca89\"\n\nexport default script","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.es/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","var aFunction = require('../internals/a-function');\nvar toObject = require('../internals/to-object');\nvar IndexedObject = require('../internals/indexed-object');\nvar toLength = require('../internals/to-length');\n\n// `Array.prototype.{ reduce, reduceRight }` methods implementation\nvar createMethod = function (IS_RIGHT) {\n  return function (that, callbackfn, argumentsLength, memo) {\n    aFunction(callbackfn);\n    var O = toObject(that);\n    var self = IndexedObject(O);\n    var length = toLength(O.length);\n    var index = IS_RIGHT ? length - 1 : 0;\n    var i = IS_RIGHT ? -1 : 1;\n    if (argumentsLength < 2) while (true) {\n      if (index in self) {\n        memo = self[index];\n        index += i;\n        break;\n      }\n      index += i;\n      if (IS_RIGHT ? index < 0 : length <= index) {\n        throw TypeError('Reduce of empty array with no initial value');\n      }\n    }\n    for (;IS_RIGHT ? index >= 0 : length > index; index += i) if (index in self) {\n      memo = callbackfn(memo, self[index], index, O);\n    }\n    return memo;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.reduce` method\n  // https://tc39.es/ecma262/#sec-array.prototype.reduce\n  left: createMethod(false),\n  // `Array.prototype.reduceRight` method\n  // https://tc39.es/ecma262/#sec-array.prototype.reduceright\n  right: createMethod(true)\n};\n","<template>\n  <div v-if=\"notes.length\" class=\"col\">\n    <p v-for=\"(ps, i) in pieces\" :key=\"i\">\n      <template v-for=\"({ text, display }, j) in ps\" :key=\"j\">\n        <span v-if=\"display === 'plain'\">{{ text }}</span>\n        <span v-else-if=\"display === 'highlight'\" class=\"highlight-font\">{{\n          text\n        }}</span>\n        <b v-else-if=\"display === 'grapheme'\">{{ text }}</b>\n        <span v-else class=\"text-ipa\">{{ text }}</span>\n      </template>\n    </p>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, PropType, defineComponent } from \"vue\";\nimport { PieceDisplay, Piece } from \"./types\";\n\nexport default defineComponent({\n  props: {\n    notes: { type: Array as PropType<string[]>, default: () => [] },\n  },\n  setup(props) {\n    function isWrapped(text: string, start: string, end: string) {\n      return text[0] === start && text[text.length - 1] === end;\n    }\n    function toPiece(text: string): Piece {\n      const patterns = [\n        [\"*\", \"*\", \"highlight\"],\n        [\"/\", \"/\", \"phoneme\"],\n        [\"<\", \">\", \"grapheme\"],\n      ] as [string, string, PieceDisplay][];\n\n      for (const [start, end, display] of patterns) {\n        if (isWrapped(text, start, end))\n          return { text: text.slice(1, -1), display };\n      }\n      return { text, display: \"plain\" };\n    }\n    const pieces = computed(() => {\n      const separator = /(\\/[^/]+\\/|<[^<>]+>|\\*[^*]+\\*)/g;\n      return props.notes.map((n) => n.split(separator).map((n) => toPiece(n)));\n    });\n    return { pieces };\n  },\n});\n</script>\n","\nimport { computed, PropType, defineComponent } from \"vue\";\nimport { PieceDisplay, Piece } from \"./types\";\n\nexport default defineComponent({\n  props: {\n    notes: { type: Array as PropType<string[]>, default: () => [] },\n  },\n  setup(props) {\n    function isWrapped(text: string, start: string, end: string) {\n      return text[0] === start && text[text.length - 1] === end;\n    }\n    function toPiece(text: string): Piece {\n      const patterns = [\n        [\"*\", \"*\", \"highlight\"],\n        [\"/\", \"/\", \"phoneme\"],\n        [\"<\", \">\", \"grapheme\"],\n      ] as [string, string, PieceDisplay][];\n\n      for (const [start, end, display] of patterns) {\n        if (isWrapped(text, start, end))\n          return { text: text.slice(1, -1), display };\n      }\n      return { text, display: \"plain\" };\n    }\n    const pieces = computed(() => {\n      const separator = /(\\/[^/]+\\/|<[^<>]+>|\\*[^*]+\\*)/g;\n      return props.notes.map((n) => n.split(separator).map((n) => toPiece(n)));\n    });\n    return { pieces };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=3ab02e56\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","import { ref } from \"vue\";\n\nexport const audio = new Audio();\nexport const id = ref(\"\");\nexport const current = ref(-1);\nexport const queue = ref<string[]>([]);\nexport const playing = ref(false);\nexport const playback = ref(0);\n\nfunction next() {\n  if (!playing.value) return;\n  current.value += 1;\n  if (current.value >= queue.value.length) stop();\n  else audio.src = queue.value[current.value];\n}\n\naudio.ontimeupdate = () =>\n  (playback.value = audio.currentTime / audio.duration);\naudio.oncanplaythrough = audio.play;\naudio.onended = next;\naudio.onerror = next;\n\nexport function play(_id: string, ...srcs: string[]) {\n  id.value = _id;\n  playing.value = true;\n  queue.value = srcs.slice();\n  current.value = -1;\n  next();\n}\n\nexport function stop() {\n  audio.pause();\n  playing.value = false;\n  queue.value.length = 0;\n  current.value = -1;\n  playback.value = 0;\n}\n"],"sourceRoot":""}