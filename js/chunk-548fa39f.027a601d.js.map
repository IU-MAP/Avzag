{"version":3,"sources":["webpack:///./src/Phrasebook/CorpusEditor.vue?2abb","webpack:///./src/Phrasebook/CorpusEditor.vue?5228","webpack:///./src/Phrasebook/Context/Editor.vue?3c88","webpack:///./src/Phrasebook/CorpusEditor.vue","webpack:///./src/Phrasebook/Context/Editor.vue","webpack:///./src/Phrasebook/Context/Editor.vue?c492","webpack:///./src/Phrasebook/Context/Editor.vue?bfca","webpack:///./node_modules/uuid/dist/esm-browser/rng.js","webpack:///./node_modules/uuid/dist/esm-browser/regex.js","webpack:///./node_modules/uuid/dist/esm-browser/validate.js","webpack:///./node_modules/uuid/dist/esm-browser/stringify.js","webpack:///./node_modules/uuid/dist/esm-browser/v4.js","webpack:///./src/Phrasebook/CorpusEditor.vue?5859","webpack:///./src/Phrasebook/CorpusEditor.vue?95e4","webpack:///./src/Phrasebook/CorpusEditor.vue?dcbf"],"names":["class","file","icon","header","addSection","s","key","id","is-on","section","name","type","item","removeSection","addPhrase","phrases","p","phrase","removePhrase","block","context","add","c","i","entity","placeholder","tags","update","remove","components","EditorCard","props","modelValue","Array","default","undefined","emits","setup","emit","get","set","value","push","length","splice","split","filter","t","map","join","immediate","deep","render","__scopeId","getRandomValues","rnds8","Uint8Array","rng","crypto","bind","msCrypto","Error","validate","uuid","test","byteToHex","toString","substr","stringify","arr","offset","arguments","toLowerCase","TypeError","v4","options","buf","rnds","random","ArrayShift","ConfirmButton","BlocksOrderEditor","ContextEditor","BlockEditor","defaultFile","filename","window","confirm","storage","contextSource","indexOf","blocks"],"mappings":"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","file":"js/chunk-548fa39f.027a601d.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CorpusEditor.vue?vue&type=style&index=2&id=31548622&lang=scss&scoped=true\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CorpusEditor.vue?vue&type=style&index=0&id=31548622&lang=scss&scoped=true\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Editor.vue?vue&type=style&index=0&id=7dce49e6&lang=scss&scoped=true\"","<template>\n  <div v-if=\"file\" class=\"section col-2 small grid\">\n    <div class=\"col-2\">\n      <EditorCard icon=\"topic\" header=\"sections\" @action=\"addSection\">\n        <template v-if=\"section\" #header>\n          <ArrayShift v-model=\"file\" :item=\"section\" />\n          <ConfirmButton @confirm=\"removeSection\" />\n        </template>\n        <div class=\"col scroll\">\n          <div v-for=\"s in file\" :key=\"s.id\" class=\"row\">\n            <btn icon=\"edit\" :is-on=\"section === s\" @click=\"section = s\" />\n            <input v-model=\"s.name\" class=\"flex\" type=\"text\" />\n          </div>\n        </div>\n      </EditorCard>\n      <EditorCard\n        v-if=\"section\"\n        icon=\"short_text\"\n        header=\"phrases\"\n        @action=\"addPhrase\"\n      >\n        <template v-if=\"phrase\" #header>\n          <ArrayShift v-model=\"section.phrases\" :item=\"phrase\" />\n          <ConfirmButton @confirm=\"removePhrase\" />\n        </template>\n        <div class=\"col scroll\">\n          <div v-for=\"p in section.phrases\" :key=\"p.id\" class=\"row\">\n            <btn icon=\"edit\" :is-on=\"phrase === p\" @click=\"phrase = p\" />\n            <input v-model=\"p.name\" class=\"flex\" type=\"text\" />\n          </div>\n        </div>\n      </EditorCard>\n      <template v-if=\"phrase\">\n        <BlocksOrderEditor\n          :key=\"phrase.id\"\n          v-model=\"block\"\n          v-model:phrase=\"phrase\"\n        />\n        <ContextEditor v-if=\"phrase\" v-model=\"phrase.context\" />\n      </template>\n    </div>\n    <BlockEditor v-if=\"block\" v-model=\"block\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport ArrayShift from \"@/components/ArrayShift.vue\";\nimport ConfirmButton from \"@/components/ConfirmButton.vue\";\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport BlocksOrderEditor from \"./Block/OrderEditor.vue\";\nimport ContextEditor from \"./Context/Editor.vue\";\nimport BlockEditor from \"./Block/Editor.vue\";\n\nimport { defineComponent, ref, provide, watch, toRaw, computed } from \"vue\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { setupEditor } from \"@/editor\";\nimport { State, Context, CorpusPhrase, CorpusSection } from \"./types\";\nimport { createContext } from \"./utils\";\n\nexport default defineComponent({\n  components: {\n    ArrayShift,\n    ConfirmButton,\n    EditorCard,\n    BlocksOrderEditor,\n    ContextEditor,\n    BlockEditor,\n  },\n  setup() {\n    const file = setupEditor<CorpusSection[]>({\n      defaultFile: [],\n      filename: () =>\n        window.confirm(\"You're resetting phrasebook corpus.\")\n          ? \"phrasebook\"\n          : \"\",\n      storage: \"editor.phrasebookCorpus\",\n    });\n    const section = ref(undefined as undefined | CorpusSection);\n    const phrase = ref(undefined as undefined | CorpusPhrase);\n    const block = ref(undefined as undefined | State[]);\n\n    const contextSource = computed(() => phrase.value?.context);\n    const context = ref({} as Context);\n    provide(\"contextSource\", contextSource);\n    provide(\"context\", context);\n    watch(\n      contextSource,\n      (contextSource) => createContext(context, contextSource),\n      { immediate: true, deep: true }\n    );\n\n    watch(file, (file) => (section.value = file[file.length - 1]), {\n      immediate: true,\n    });\n    watch(\n      section,\n      (section) =>\n        (phrase.value = section?.phrases?.[section.phrases.length - 1]),\n      { immediate: true }\n    );\n    watch(\n      phrase,\n      (phrase) => (block.value = phrase?.blocks?.[phrase.blocks.length - 1]),\n      { immediate: true }\n    );\n\n    function addSection() {\n      const s = {\n        id: uuidv4(),\n        name: \"New section\",\n        phrases: [],\n      };\n      file.value.push(s);\n      section.value = s;\n    }\n    function removeSection() {\n      if (!section.value) return;\n      file.value.splice(toRaw(file.value).indexOf(toRaw(section.value)), 1);\n      section.value = file.value[file.value.length - 1];\n    }\n    function addPhrase() {\n      if (!section.value) return;\n      const p: CorpusPhrase = {\n        id: uuidv4(),\n        name: \"New phrase\",\n        context: [],\n        blocks: [],\n      };\n      section.value.phrases.push(p);\n      phrase.value = p;\n    }\n    function removePhrase() {\n      if (!section.value || !phrase.value) return;\n      const phrases = toRaw(section.value.phrases);\n      phrases.splice(phrases.indexOf(toRaw(phrase.value)), 1);\n      phrase.value = phrases[phrases.length - 1];\n    }\n\n    return {\n      file,\n      section,\n      phrase,\n      block,\n      addSection,\n      removeSection,\n      addPhrase,\n      removePhrase,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n#header {\n  margin-top: -1 * map-get($margins, \"double\");\n  padding-top: 2 * map-get($margins, \"normal\");\n}\n.grid {\n  display: grid;\n  grid-template-columns: minmax(0, 1fr) minmax(0, 1.5fr);\n  gap: map-get($margins, \"double\");\n}\n@media only screen and (max-width: $mobile-width) {\n  .grid {\n    grid-template-columns: 100%;\n  }\n}\n</style>\n\n<style lang=\"scss\">\n.block-editor {\n  gap: 4px 8px;\n}\n</style>\n\n<style lang=\"scss\" scoped>\n.scroll {\n  max-height: 128px;\n}\n</style>\n","<template>\n  <EditorCard icon=\"list_alt\" header=\"context\" @action=\"add\">\n    <div class=\"col scroll\">\n      <div v-for=\"(c, i) in context\" :key=\"i\" class=\"row\">\n        <input\n          v-model=\"c.entity\"\n          class=\"entity\"\n          :class=\"'colored-' + i\"\n          type=\"text\"\n          placeholder=\"entity\"\n        />\n        <input\n          v-model=\"tags[i]\"\n          class=\"flex\"\n          type=\"text\"\n          placeholder=\"tags\"\n          @change=\"update(i)\"\n        />\n        <btn icon=\"clear\" @click=\"remove(i)\" />\n      </div>\n    </div>\n  </EditorCard>\n</template>\n\n<script lang=\"ts\">\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport { computed, defineComponent, PropType, ref, watch } from \"vue\";\nimport { ContextSource } from \"../types\";\n\nexport default defineComponent({\n  name: \"ContextEditor\",\n  components: { EditorCard },\n  props: {\n    modelValue: {\n      type: Array as PropType<ContextSource[]>,\n      default: undefined,\n    },\n  },\n  emits: [\"update:modelValue\"],\n  setup(props, { emit }) {\n    const context = computed({\n      get: () => props.modelValue,\n      set: (c) => emit(\"update:modelValue\", c),\n    });\n    const tags = ref([] as string[]);\n    watch(\n      context,\n      (context) => (tags.value = context.map(({ tags }) => tags.join(\" \"))),\n      { immediate: true, deep: true }\n    );\n\n    function add() {\n      if (!context.value) context.value = [];\n      context.value.push({\n        entity: \"entity #\" + context.value.length,\n        tags: [],\n      });\n    }\n    function remove(i: number) {\n      context.value.splice(i, 1);\n    }\n    function update(i: number) {\n      context.value[i].tags = tags.value[i].split(\" \").filter((t) => t);\n    }\n\n    return { context, tags, add, remove, update };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.entity {\n  width: 96px;\n}\n.scroll {\n  max-height: 128px;\n}\n</style>\n","\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport { computed, defineComponent, PropType, ref, watch } from \"vue\";\nimport { ContextSource } from \"../types\";\n\nexport default defineComponent({\n  name: \"ContextEditor\",\n  components: { EditorCard },\n  props: {\n    modelValue: {\n      type: Array as PropType<ContextSource[]>,\n      default: undefined,\n    },\n  },\n  emits: [\"update:modelValue\"],\n  setup(props, { emit }) {\n    const context = computed({\n      get: () => props.modelValue,\n      set: (c) => emit(\"update:modelValue\", c),\n    });\n    const tags = ref([] as string[]);\n    watch(\n      context,\n      (context) => (tags.value = context.map(({ tags }) => tags.join(\" \"))),\n      { immediate: true, deep: true }\n    );\n\n    function add() {\n      if (!context.value) context.value = [];\n      context.value.push({\n        entity: \"entity #\" + context.value.length,\n        tags: [],\n      });\n    }\n    function remove(i: number) {\n      context.value.splice(i, 1);\n    }\n    function update(i: number) {\n      context.value[i].tags = tags.value[i].split(\" \").filter((t) => t);\n    }\n\n    return { context, tags, add, remove, update };\n  },\n});\n","import { render } from \"./Editor.vue?vue&type=template&id=7dce49e6&scoped=true\"\nimport script from \"./Editor.vue?vue&type=script&lang=ts\"\nexport * from \"./Editor.vue?vue&type=script&lang=ts\"\n\nimport \"./Editor.vue?vue&type=style&index=0&id=7dce49e6&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-7dce49e6\"\n\nexport default script","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;","\nimport ArrayShift from \"@/components/ArrayShift.vue\";\nimport ConfirmButton from \"@/components/ConfirmButton.vue\";\nimport EditorCard from \"@/components/EditorCard.vue\";\nimport BlocksOrderEditor from \"./Block/OrderEditor.vue\";\nimport ContextEditor from \"./Context/Editor.vue\";\nimport BlockEditor from \"./Block/Editor.vue\";\n\nimport { defineComponent, ref, provide, watch, toRaw, computed } from \"vue\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { setupEditor } from \"@/editor\";\nimport { State, Context, CorpusPhrase, CorpusSection } from \"./types\";\nimport { createContext } from \"./utils\";\n\nexport default defineComponent({\n  components: {\n    ArrayShift,\n    ConfirmButton,\n    EditorCard,\n    BlocksOrderEditor,\n    ContextEditor,\n    BlockEditor,\n  },\n  setup() {\n    const file = setupEditor<CorpusSection[]>({\n      defaultFile: [],\n      filename: () =>\n        window.confirm(\"You're resetting phrasebook corpus.\")\n          ? \"phrasebook\"\n          : \"\",\n      storage: \"editor.phrasebookCorpus\",\n    });\n    const section = ref(undefined as undefined | CorpusSection);\n    const phrase = ref(undefined as undefined | CorpusPhrase);\n    const block = ref(undefined as undefined | State[]);\n\n    const contextSource = computed(() => phrase.value?.context);\n    const context = ref({} as Context);\n    provide(\"contextSource\", contextSource);\n    provide(\"context\", context);\n    watch(\n      contextSource,\n      (contextSource) => createContext(context, contextSource),\n      { immediate: true, deep: true }\n    );\n\n    watch(file, (file) => (section.value = file[file.length - 1]), {\n      immediate: true,\n    });\n    watch(\n      section,\n      (section) =>\n        (phrase.value = section?.phrases?.[section.phrases.length - 1]),\n      { immediate: true }\n    );\n    watch(\n      phrase,\n      (phrase) => (block.value = phrase?.blocks?.[phrase.blocks.length - 1]),\n      { immediate: true }\n    );\n\n    function addSection() {\n      const s = {\n        id: uuidv4(),\n        name: \"New section\",\n        phrases: [],\n      };\n      file.value.push(s);\n      section.value = s;\n    }\n    function removeSection() {\n      if (!section.value) return;\n      file.value.splice(toRaw(file.value).indexOf(toRaw(section.value)), 1);\n      section.value = file.value[file.value.length - 1];\n    }\n    function addPhrase() {\n      if (!section.value) return;\n      const p: CorpusPhrase = {\n        id: uuidv4(),\n        name: \"New phrase\",\n        context: [],\n        blocks: [],\n      };\n      section.value.phrases.push(p);\n      phrase.value = p;\n    }\n    function removePhrase() {\n      if (!section.value || !phrase.value) return;\n      const phrases = toRaw(section.value.phrases);\n      phrases.splice(phrases.indexOf(toRaw(phrase.value)), 1);\n      phrase.value = phrases[phrases.length - 1];\n    }\n\n    return {\n      file,\n      section,\n      phrase,\n      block,\n      addSection,\n      removeSection,\n      addPhrase,\n      removePhrase,\n    };\n  },\n});\n","import { render } from \"./CorpusEditor.vue?vue&type=template&id=31548622&scoped=true\"\nimport script from \"./CorpusEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./CorpusEditor.vue?vue&type=script&lang=ts\"\n\nimport \"./CorpusEditor.vue?vue&type=style&index=0&id=31548622&lang=scss&scoped=true\"\nimport \"./CorpusEditor.vue?vue&type=style&index=1&id=31548622&lang=scss\"\nimport \"./CorpusEditor.vue?vue&type=style&index=2&id=31548622&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-31548622\"\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CorpusEditor.vue?vue&type=style&index=1&id=31548622&lang=scss\""],"sourceRoot":""}