{"version":3,"sources":["webpack:///./src/Phrasebook/index.vue?44c5","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack:///./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack:///./src/Phrasebook/State/index.vue?4761","webpack:///./src/Phrasebook/index.vue","webpack:///./src/Phrasebook/PhraseCard.vue","webpack:///./src/Phrasebook/PhraseCard.vue?0f23","webpack:///./src/Phrasebook/PhraseCard.vue?dc76","webpack:///./src/Phrasebook/main.ts","webpack:///./src/Phrasebook/index.vue?dcc3","webpack:///./src/Phrasebook/index.vue?b05c","webpack:///./node_modules/core-js/modules/es.array.some.js","webpack:///./src/Phrasebook/Context/index.vue","webpack:///./src/Phrasebook/Context/index.vue?ec8a","webpack:///./src/Phrasebook/Context/index.vue?3f4e","webpack:///./src/Phrasebook/Context/index.vue?fa1e","webpack:///./src/Phrasebook/Block/index.vue","webpack:///./src/Phrasebook/Block/index.vue?471d","webpack:///./src/Phrasebook/Block/index.vue?892b","webpack:///./src/Phrasebook/PhraseCard.vue?3635","webpack:///./src/Phrasebook/utils.ts","webpack:///./src/Phrasebook/State/index.vue","webpack:///./src/Phrasebook/State/index.vue?b225","webpack:///./src/Phrasebook/State/index.vue?b39a","webpack:///./node_modules/core-js/modules/es.array.index-of.js","webpack:///./src/Phrasebook/Block/index.vue?3389"],"names":["_arrayWithoutHoles","arr","Array","isArray","arrayLikeToArray","_iterableToArray","iter","Symbol","iterator","Object","from","_nonIterableSpread","TypeError","_toConsumableArray","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","class","corpus","searching","icon","query","type","placeholder","section","style","select","s","key","id","value","name","phrases","ps","p","text","is-on","phrase","phrasebooks","n","lect","playing","copy","glossed","translation","context","blocks","vblocks","b","i","seekers","block","$event","notes","components","Context","Block","Notes","Flag","props","String","default","undefined","setup","filter","state","map","join","navigator","clipboard","writeText","get","set","play","texts","plain","stop","seek","current","previous","render","__scopeId","initialize","PhraseCard","immediate","reduce","result","index","includes","length","_section","_phrase","$","$some","some","arrayMethodIsStrict","arrayMethodUsesToLength","STRICT_METHOD","USES_TO_LENGTH","target","proto","forced","callbackfn","this","arguments","any","translated","tags","tag","explicit","condition","conditions","entries","forEach","entity","Set","add","translate","d","k","has","disabled","move","VState","Boolean","emits","emit","transition","switchState","nextState","states","indexOf","deep","newState","createContext","source","checkConditions","score","count","flag","findBestState","indexes","candidates","candidate","c","applyConditions","additive","delete","canGloss","types","j","textColors","dashColors","entities","keys","ipa","gloss","lines","t","e","values","$indexOf","nativeIndexOf","NEGATIVE_ZERO","ACCESSORS","1","searchElement","apply"],"mappings":"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","file":"js/chunk-1b635454.afa60152.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=71753b3c&lang=scss&scoped=true\"","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithoutHoles from \"@babel/runtime/helpers/esm/arrayWithoutHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableSpread from \"@babel/runtime/helpers/esm/nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=661aca89&lang=scss&scoped=true\"","<template>\n  <div v-if=\"corpus\" class=\"section col-1\">\n    <div class=\"col-1\">\n      <div class=\"row\">\n        <toggle v-model=\"searching\" icon=\"search\" />\n        <input\n          v-if=\"searching\"\n          v-model=\"query\"\n          class=\"flex\"\n          type=\"text\"\n          placeholder=\"Search all phrases...\"\n        />\n        <h2 v-else class=\"col-1 flex\">\n          <select\n            v-model=\"section\"\n            style=\"flex: none\"\n            @change=\"select(section)\"\n          >\n            <option v-for=\"s in corpus\" :key=\"s.id\" :value=\"s\">\n              {{ s.name }}\n            </option>\n          </select>\n        </h2>\n      </div>\n      <div class=\"scroll\">\n        <div v-if=\"searching\" class=\"col\">\n          <div v-for=\"(ps, s) of phrases\" :key=\"s\" class=\"col\">\n            <h2>{{ corpus[s].name }}</h2>\n            <div class=\"col-0\">\n              <btn\n                v-for=\"p in ps\"\n                :key=\"p\"\n                :text=\"corpus[s].phrases[p].name\"\n                :is-on=\"phrase === corpus[s].phrases[p]\"\n                @click=\"select(corpus[s], corpus[s].phrases[p])\"\n              />\n            </div>\n          </div>\n        </div>\n        <div v-else class=\"col-0\">\n          <btn\n            v-for=\"p in phrases\"\n            :key=\"p.id\"\n            :text=\"p.name\"\n            :is-on=\"phrase === p\"\n            @click=\"select(null, p)\"\n          />\n        </div>\n      </div>\n    </div>\n    <div v-if=\"phrase\" :key=\"phrase.id\" class=\"col-1\">\n      <PhraseCard :phrase=\"phrase\" />\n      <PhraseCard\n        v-for=\"(p, n) of phrasebooks\"\n        :key=\"n\"\n        :lect=\"n\"\n        :phrase=\"p[phrase.id]\"\n      />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport PhraseCard from \"./PhraseCard.vue\";\n\nimport { computed, ref, watch, defineComponent, provide } from \"vue\";\n\nimport { corpus, section, phrase, phrasebooks, initialize } from \"./main\";\nimport { Context, CorpusPhrase, CorpusSection } from \"./types\";\nimport { createContext } from \"./utils\";\n\nexport default defineComponent({\n  components: { PhraseCard },\n  setup() {\n    initialize();\n\n    const context = ref({} as Context);\n    watch(phrase, (phrase) => createContext(context, phrase?.context), {\n      immediate: true,\n    });\n\n    provide(\"context\", context);\n\n    const searching = ref(false);\n    const query = ref(\"\");\n\n    const phrases = computed(() =>\n      searching.value\n        ? corpus.value.reduce((result, section, index) => {\n            result[index] = section.phrases\n              .map((phrase, index) => [phrase, index] as [CorpusPhrase, number])\n              .filter(([phrase]) => phrase.name.includes(query.value))\n              .map(([, index]) => index);\n            if (!result[index].length) delete result[index];\n            return result;\n          }, {} as Record<number, number[]>)\n        : section.value?.phrases\n    );\n    function select(_section?: CorpusSection, _phrase?: CorpusPhrase) {\n      if (_section) section.value = _section;\n      phrase.value = _phrase ?? section.value?.phrases[0];\n    }\n\n    return {\n      searching,\n      query,\n      corpus,\n      section,\n      phrase,\n      select,\n      phrases,\n      phrasebooks,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.section {\n  display: grid;\n  grid-template-columns: 288px minmax(0, 1fr);\n  gap: map-get($margins, \"normal\");\n  > :first-child {\n    max-height: 640px;\n  }\n}\n@media only screen and (max-width: $mobile-width) {\n  .section {\n    > :first-child {\n      max-height: 320px;\n    }\n    grid-template-columns: 100%;\n  }\n}\n</style>\n","<template>\n  <div v-if=\"phrase\" class=\"col card flag\">\n    <Flag :lect=\"lect\" class=\"blur\" />\n    <div v-if=\"lect\" class=\"row small wrap\" style=\"width: 100%\">\n      <h2 class=\"flex\">{{ lect }}</h2>\n      <div class=\"row\">\n        <toggle v-model=\"playing\" icon=\"play_arrow\" />\n        <btn icon=\"content_copy\" @click=\"copy\" />\n        <toggle v-model=\"glossed\" icon=\"layers\" />\n      </div>\n    </div>\n    <Context :translation=\"lect ? phrase.context : null\" :blocks=\"vblocks\" />\n    <div class=\"row wrap flex\">\n      <div v-for=\"(b, i) in phrase.blocks\" :key=\"i\" class=\"blocks row\">\n        <p class=\"seeker\" :style=\"{ width: seekers[i] }\" />\n        <Block :block=\"b\" :glossed=\"glossed\" @update=\"vblocks[i] = $event\" />\n      </div>\n    </div>\n    <Notes class=\"text-caption\" :notes=\"phrase.notes\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport Context from \"./Context/index.vue\";\nimport Block from \"./Block/index.vue\";\nimport Notes from \"@/components/Notes/index.vue\";\nimport Flag from \"@/components/Flag.vue\";\n\nimport { computed, defineComponent, PropType, reactive, ref, watch } from \"vue\";\n\nimport { Phrase, BlockSnapshot } from \"./types\";\nimport player from \"@/audio-player\";\n\nexport default defineComponent({\n  components: { Context, Block, Notes, Flag },\n  props: {\n    lect: { type: String, default: \"\" },\n    phrase: { type: Object as PropType<Phrase>, default: undefined },\n  },\n  setup(props) {\n    const glossed = ref(false);\n    const vblocks = reactive([] as BlockSnapshot[]);\n\n    const text = computed(() =>\n      vblocks\n        .filter(({ state }) => state)\n        .map(({ text }) => text)\n        .join(\" \")\n    );\n    function copy() {\n      navigator.clipboard.writeText(text.value);\n    }\n\n    const playing = computed({\n      get: () => player.key === props.lect,\n      set: (p) => {\n        if (p)\n          player.play(\n            props.lect,\n            vblocks\n              .map(({ state }) => state?.texts.map(({ plain }) => plain))\n              .map((p) => \"phrasebook/\" + (p?.join(\"\") ?? \"\"))\n          );\n        else player.stop();\n      },\n    });\n\n    const seekers = ref([] as string[]);\n    watch(\n      [() => player.seek, () => player.current, playing],\n      ([seek, current, playing], [, previous]) => {\n        if (previous) seekers.value[previous.i] = \"0\";\n        if (playing && current) seekers.value[current.i] = seek * 100 + \"%\";\n      }\n    );\n\n    return { glossed, vblocks, copy, playing, seekers };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.card {\n  align-items: flex-start;\n}\n.blocks {\n  position: relative;\n}\n.seeker {\n  padding: 0;\n  background-color: var(--color-text);\n  border-radius: $border-radius $border-radius 0 0;\n  height: $border-radius;\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n</style>\n","\nimport Context from \"./Context/index.vue\";\nimport Block from \"./Block/index.vue\";\nimport Notes from \"@/components/Notes/index.vue\";\nimport Flag from \"@/components/Flag.vue\";\n\nimport { computed, defineComponent, PropType, reactive, ref, watch } from \"vue\";\n\nimport { Phrase, BlockSnapshot } from \"./types\";\nimport player from \"@/audio-player\";\n\nexport default defineComponent({\n  components: { Context, Block, Notes, Flag },\n  props: {\n    lect: { type: String, default: \"\" },\n    phrase: { type: Object as PropType<Phrase>, default: undefined },\n  },\n  setup(props) {\n    const glossed = ref(false);\n    const vblocks = reactive([] as BlockSnapshot[]);\n\n    const text = computed(() =>\n      vblocks\n        .filter(({ state }) => state)\n        .map(({ text }) => text)\n        .join(\" \")\n    );\n    function copy() {\n      navigator.clipboard.writeText(text.value);\n    }\n\n    const playing = computed({\n      get: () => player.key === props.lect,\n      set: (p) => {\n        if (p)\n          player.play(\n            props.lect,\n            vblocks\n              .map(({ state }) => state?.texts.map(({ plain }) => plain))\n              .map((p) => \"phrasebook/\" + (p?.join(\"\") ?? \"\"))\n          );\n        else player.stop();\n      },\n    });\n\n    const seekers = ref([] as string[]);\n    watch(\n      [() => player.seek, () => player.current, playing],\n      ([seek, current, playing], [, previous]) => {\n        if (previous) seekers.value[previous.i] = \"0\";\n        if (playing && current) seekers.value[current.i] = seek * 100 + \"%\";\n      }\n    );\n\n    return { glossed, vblocks, copy, playing, seekers };\n  },\n});\n","import { render } from \"./PhraseCard.vue?vue&type=template&id=1a1f26ed&scoped=true\"\nimport script from \"./PhraseCard.vue?vue&type=script&lang=ts\"\nexport * from \"./PhraseCard.vue?vue&type=script&lang=ts\"\n\nimport \"./PhraseCard.vue?vue&type=style&index=0&id=1a1f26ed&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-1a1f26ed\"\n\nexport default script","import { getInitializer, loadJSON, loadLectsJSON } from \"@/store\";\nimport { shallowRef } from \"vue\";\nimport { CorpusPhrase, CorpusSection, Phrasebook } from \"./types\";\n\nexport const corpus = shallowRef<CorpusSection[]>([]);\nexport const phrasebooks = shallowRef<Record<string, Phrasebook>>();\nexport const section = shallowRef<CorpusSection>();\nexport const phrase = shallowRef<CorpusPhrase>();\n\nexport const initialize = getInitializer(async () => {\n  corpus.value = await loadJSON(\"phrasebook\");\n  phrasebooks.value = await loadLectsJSON<Phrasebook>(\"phrasebook\");\n\n  section.value = corpus.value[0];\n  phrase.value = section.value.phrases[0];\n});\n","\nimport PhraseCard from \"./PhraseCard.vue\";\n\nimport { computed, ref, watch, defineComponent, provide } from \"vue\";\n\nimport { corpus, section, phrase, phrasebooks, initialize } from \"./main\";\nimport { Context, CorpusPhrase, CorpusSection } from \"./types\";\nimport { createContext } from \"./utils\";\n\nexport default defineComponent({\n  components: { PhraseCard },\n  setup() {\n    initialize();\n\n    const context = ref({} as Context);\n    watch(phrase, (phrase) => createContext(context, phrase?.context), {\n      immediate: true,\n    });\n\n    provide(\"context\", context);\n\n    const searching = ref(false);\n    const query = ref(\"\");\n\n    const phrases = computed(() =>\n      searching.value\n        ? corpus.value.reduce((result, section, index) => {\n            result[index] = section.phrases\n              .map((phrase, index) => [phrase, index] as [CorpusPhrase, number])\n              .filter(([phrase]) => phrase.name.includes(query.value))\n              .map(([, index]) => index);\n            if (!result[index].length) delete result[index];\n            return result;\n          }, {} as Record<number, number[]>)\n        : section.value?.phrases\n    );\n    function select(_section?: CorpusSection, _phrase?: CorpusPhrase) {\n      if (_section) section.value = _section;\n      phrase.value = _phrase ?? section.value?.phrases[0];\n    }\n\n    return {\n      searching,\n      query,\n      corpus,\n      section,\n      phrase,\n      select,\n      phrases,\n      phrasebooks,\n    };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=71753b3c&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=71753b3c&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-71753b3c\"\n\nexport default script","'use strict';\nvar $ = require('../internals/export');\nvar $some = require('../internals/array-iteration').some;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar STRICT_METHOD = arrayMethodIsStrict('some');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('some');\n\n// `Array.prototype.some` method\n// https://tc39.es/ecma262/#sec-array.prototype.some\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || !USES_TO_LENGTH }, {\n  some: function some(callbackfn /* , thisArg */) {\n    return $some(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","<template>\n  <div class=\"row text-caption wrap\">\n    <div class=\"icon\">info</div>\n    <template v-if=\"any\">\n      <template v-for=\"(tags, i) of translated\" :key=\"i\">\n        <template v-if=\"tags.length\" class=\"row-0 wrap\">\n          <p\n            v-for=\"tag in tags\"\n            :key=\"tag + '--' + i\"\n            :class=\"'colored-dot-' + i\"\n          >\n            {{ tag }}\n          </p>\n        </template>\n      </template>\n    </template>\n    <template v-else>…</template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, inject, Ref, PropType } from \"vue\";\nimport { Context, ContextTranslation, BlockSnapshot } from \"../types\";\n\nexport default defineComponent({\n  name: \"Context\",\n  props: {\n    translation: {\n      type: Object as PropType<ContextTranslation>,\n      default: () => ({}),\n    },\n    blocks: { type: Array as PropType<BlockSnapshot[]>, default: () => [] },\n  },\n  setup(props) {\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    const explicit = computed(() => {\n      const result = {} as Context;\n      for (const { state } of props.blocks) {\n        const condition = state?.conditions;\n        if (!condition) continue;\n        Object.entries(condition).forEach(([entity, tags]) =>\n          Object.entries(tags).forEach(([tag]) => {\n            if (!result[entity]) result[entity] = new Set();\n            result[entity].add(tag);\n          })\n        );\n      }\n      return result;\n    });\n\n    function translate(d: undefined | Record<string, string>, k: string) {\n      return d?.[k] || k;\n    }\n    const translated = computed(() =>\n      Object.entries(context.value).map(([entity, tags]) =>\n        [...tags]\n          .filter((tag) => !explicit.value[entity]?.has(tag))\n          .map((tag) => translate(props.translation?.[entity], tag))\n      )\n    );\n    const any = computed(() => translated.value.some((tags) => tags?.length));\n\n    return { translated, any };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\ndiv.icon {\n  font-size: map-get($font-sizes, \"small\");\n}\np:not(:last-child)::after {\n  content: \",\";\n}\n</style>\n","\nimport { computed, defineComponent, inject, Ref, PropType } from \"vue\";\nimport { Context, ContextTranslation, BlockSnapshot } from \"../types\";\n\nexport default defineComponent({\n  name: \"Context\",\n  props: {\n    translation: {\n      type: Object as PropType<ContextTranslation>,\n      default: () => ({}),\n    },\n    blocks: { type: Array as PropType<BlockSnapshot[]>, default: () => [] },\n  },\n  setup(props) {\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    const explicit = computed(() => {\n      const result = {} as Context;\n      for (const { state } of props.blocks) {\n        const condition = state?.conditions;\n        if (!condition) continue;\n        Object.entries(condition).forEach(([entity, tags]) =>\n          Object.entries(tags).forEach(([tag]) => {\n            if (!result[entity]) result[entity] = new Set();\n            result[entity].add(tag);\n          })\n        );\n      }\n      return result;\n    });\n\n    function translate(d: undefined | Record<string, string>, k: string) {\n      return d?.[k] || k;\n    }\n    const translated = computed(() =>\n      Object.entries(context.value).map(([entity, tags]) =>\n        [...tags]\n          .filter((tag) => !explicit.value[entity]?.has(tag))\n          .map((tag) => translate(props.translation?.[entity], tag))\n      )\n    );\n    const any = computed(() => translated.value.some((tags) => tags?.length));\n\n    return { translated, any };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=40007e60&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=40007e60&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-40007e60\"\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=40007e60&lang=scss&scoped=true\"","<template>\n  <button\n    v-show=\"text\"\n    v-if=\"state\"\n    class=\"small\"\n    :class=\"{ disabled, glossed }\"\n    @click=\"move\"\n  >\n    <VState :glossed=\"glossed\" :state=\"state\" @text=\"text = $event\" />\n  </button>\n</template>\n\n<script lang=\"ts\">\nimport VState from \"../State/index.vue\";\n\nimport {\n  computed,\n  defineComponent,\n  inject,\n  PropType,\n  ref,\n  Ref,\n  toRaw,\n  watch,\n} from \"vue\";\nimport { Context, State } from \"../types\";\nimport { applyConditions, findBestState, checkConditions } from \"../utils\";\n\nexport default defineComponent({\n  name: \"Block\",\n  components: { VState },\n  props: {\n    block: { type: Array as PropType<State[]>, default: undefined },\n    glossed: Boolean,\n  },\n  emits: [\"update\"],\n  setup(props, { emit }) {\n    const state = ref<State>();\n    const text = ref(\"\");\n    watch(\n      [state, text],\n      ([state, text]) =>\n        emit(\"update\", {\n          state,\n          text,\n        }),\n      { immediate: true }\n    );\n    const disabled = computed(() => !state.value?.transition);\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    function switchState(nextState: undefined | State) {\n      if (toRaw(nextState) === toRaw(state.value)) return;\n      applyConditions(context, state.value?.conditions, false);\n      applyConditions(context, nextState?.conditions, true);\n      state.value = nextState;\n    }\n    watch(\n      context,\n      (context) => {\n        const nextState = findBestState(undefined, props.block, context);\n        switchState(nextState);\n      },\n      { immediate: true, deep: true }\n    );\n\n    function move() {\n      if (disabled.value) return;\n      const transition = state.value?.transition;\n      const states = props.block;\n      let nextState;\n\n      if (transition === \"next\") {\n        const i = state.value ? states.indexOf(toRaw(state.value)) : -1;\n        nextState = states[(i + 1) % states.length];\n      } else if (transition)\n        nextState = findBestState(transition, states, context.value);\n\n      switchState(nextState);\n      if (checkConditions(nextState?.conditions, context.value)[0] < 0)\n        state.value = undefined;\n    }\n\n    return {\n      move,\n      state,\n      disabled,\n      text,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\nbutton {\n  height: fit-content;\n  padding: 0;\n  &.disabled {\n    padding: 0;\n    background-color: transparent;\n    &:hover,\n    &:active {\n      background-color: transparent;\n    }\n    cursor: default;\n  }\n  &:not(.disabled) > * {\n    padding: 0 map-get($margins, \"normal\");\n  }\n}\n</style>\n","\nimport VState from \"../State/index.vue\";\n\nimport {\n  computed,\n  defineComponent,\n  inject,\n  PropType,\n  ref,\n  Ref,\n  toRaw,\n  watch,\n} from \"vue\";\nimport { Context, State } from \"../types\";\nimport { applyConditions, findBestState, checkConditions } from \"../utils\";\n\nexport default defineComponent({\n  name: \"Block\",\n  components: { VState },\n  props: {\n    block: { type: Array as PropType<State[]>, default: undefined },\n    glossed: Boolean,\n  },\n  emits: [\"update\"],\n  setup(props, { emit }) {\n    const state = ref<State>();\n    const text = ref(\"\");\n    watch(\n      [state, text],\n      ([state, text]) =>\n        emit(\"update\", {\n          state,\n          text,\n        }),\n      { immediate: true }\n    );\n    const disabled = computed(() => !state.value?.transition);\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    function switchState(nextState: undefined | State) {\n      if (toRaw(nextState) === toRaw(state.value)) return;\n      applyConditions(context, state.value?.conditions, false);\n      applyConditions(context, nextState?.conditions, true);\n      state.value = nextState;\n    }\n    watch(\n      context,\n      (context) => {\n        const nextState = findBestState(undefined, props.block, context);\n        switchState(nextState);\n      },\n      { immediate: true, deep: true }\n    );\n\n    function move() {\n      if (disabled.value) return;\n      const transition = state.value?.transition;\n      const states = props.block;\n      let nextState;\n\n      if (transition === \"next\") {\n        const i = state.value ? states.indexOf(toRaw(state.value)) : -1;\n        nextState = states[(i + 1) % states.length];\n      } else if (transition)\n        nextState = findBestState(transition, states, context.value);\n\n      switchState(nextState);\n      if (checkConditions(nextState?.conditions, context.value)[0] < 0)\n        state.value = undefined;\n    }\n\n    return {\n      move,\n      state,\n      disabled,\n      text,\n    };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=380e7c9d&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=380e7c9d&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-380e7c9d\"\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PhraseCard.vue?vue&type=style&index=0&id=1a1f26ed&lang=scss&scoped=true\"","import { Ref } from \"vue\";\nimport { Context, State, Conditions, ContextSource } from \"./types\";\n\nexport function newState() {\n  return {\n    texts: [{ plain: \"new state\" }],\n    transition: \"next\",\n    conditions: {},\n  } as State;\n}\n\nexport function createContext(context: Ref<Context>, source?: ContextSource[]) {\n  if (!source) return;\n  context.value = {};\n  source.forEach(({ entity }) => (context.value[entity] = new Set()));\n}\n\nexport function checkConditions(\n  conditions: undefined | Conditions,\n  context: Context\n): [number, number] {\n  if (!conditions) return [1, 0];\n  let score = 0;\n  let count = 0;\n  for (const [entity, tags] of Object.entries(conditions))\n    for (const [tag, flag] of Object.entries(tags)) {\n      const has = context[entity]?.has(tag);\n      if (!flag && !has) return [-1, 0];\n      if (has) score += 1;\n      count += 1;\n    }\n  return [score / (count || 1), count];\n}\n\nexport function findBestState(\n  indexes: undefined | number[],\n  states: State[],\n  context: Context\n): undefined | State {\n  let state;\n  let score = -1;\n  let count = 0;\n\n  const candidates = indexes?.map((i) => states[i]) ?? states;\n  candidates.forEach((candidate) => {\n    const [s, c] = checkConditions(candidate.conditions, context);\n    if (score === 1 ? s === 1 && c > count : s > score) {\n      state = candidate;\n      score = s;\n      count = c;\n    }\n  });\n  return state;\n}\n\nexport function applyConditions(\n  context: Ref<Context>,\n  conditions: undefined | Conditions,\n  additive: boolean\n) {\n  if (!conditions || !context.value) return;\n  Object.entries(conditions).forEach(([entity, tags]) =>\n    Object.entries(tags).forEach(([tag, flag]) => {\n      const set = context.value[entity];\n      if (!flag || !set) return;\n      if (additive) set.add(tag);\n      else set.delete(tag);\n    })\n  );\n}\n","<template>\n  <div class=\"display row\" :class=\"{ glossed: canGloss }\">\n    <div class=\"segments\">\n      <p v-for=\"(type, i) in types\" :key=\"type\" :class=\"'text-' + type\">\n        <span v-for=\"(text, j) in texts[i]\" :key=\"j\" :class=\"textColors[j]\">\n          {{ text }}\n        </span>\n      </p>\n    </div>\n    <div class=\"row dashes\">\n      <p v-for=\"(c, i) in dashColors\" :key=\"i\" :class=\"c\" />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, inject, PropType, Ref, watch } from \"vue\";\nimport { Context, State } from \"../types\";\n\nexport default defineComponent({\n  name: \"State\",\n  props: {\n    state: { type: Object as PropType<State>, default: () => ({}) },\n    glossed: { type: Boolean, default: false },\n  },\n  emits: [\"text\"],\n  setup(props, { emit }) {\n    const context = inject(\"context\", {} as Ref<Context>);\n    const entities = computed(() => Object.keys(context.value));\n    const canGloss = computed(\n      () =>\n        props.glossed &&\n        props.state.texts.some(({ ipa, gloss }) => ipa || gloss)\n    );\n\n    const types = computed<(\"plain\" | \"ipa\" | \"gloss\")[]>(() =>\n      canGloss.value ? [\"ipa\", \"gloss\"] : [\"plain\"]\n    );\n    const texts = computed(() =>\n      types.value.map((type) => props.state.texts?.map((text) => text[type]))\n    );\n    watch(\n      texts,\n      (texts) => {\n        if (!texts) return;\n        const lines = texts.map((t) => t?.join(\"\"));\n        const text = lines.length === 1 ? lines[0] : lines.join(\"\\n\");\n        emit(\"text\", text);\n      },\n      { immediate: true, deep: true }\n    );\n\n    const textColors = computed(() =>\n      props.state.texts\n        .map(({ entity }) => entity ?? \"\")\n        .map((e) => entities.value.indexOf(e))\n        .map((i) => \"colored-\" + i)\n    );\n    const dashColors = computed(() =>\n      props.state.transition && props.state.conditions\n        ? Object.entries(props.state.conditions)\n            .filter(([, tags]) => Object.values(tags).some((flag) => flag))\n            .map(([entity]) => entities.value.indexOf(entity))\n            .map((i) => \"colored-back-\" + i)\n        : []\n    );\n\n    return { types, texts, canGloss, textColors, dashColors };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.display {\n  height: map-get($button-height, \"small\");\n  position: relative;\n  &.glossed {\n    height: map-get($button-height, \"normal\") + map-get($margins, \"normal\");\n  }\n}\n.segments {\n  display: flex;\n  flex-direction: column;\n  p {\n    display: flex;\n    place-content: center;\n  }\n}\n.dashes {\n  overflow: hidden;\n  border-radius: 0 0 $border-radius $border-radius;\n  height: $border-radius;\n  width: 100%;\n  left: 0;\n  justify-content: center;\n  position: absolute;\n  bottom: 0;\n  > * {\n    height: 100%;\n    width: 4 * $border-radius;\n  }\n}\n</style>\n","\nimport { computed, defineComponent, inject, PropType, Ref, watch } from \"vue\";\nimport { Context, State } from \"../types\";\n\nexport default defineComponent({\n  name: \"State\",\n  props: {\n    state: { type: Object as PropType<State>, default: () => ({}) },\n    glossed: { type: Boolean, default: false },\n  },\n  emits: [\"text\"],\n  setup(props, { emit }) {\n    const context = inject(\"context\", {} as Ref<Context>);\n    const entities = computed(() => Object.keys(context.value));\n    const canGloss = computed(\n      () =>\n        props.glossed &&\n        props.state.texts.some(({ ipa, gloss }) => ipa || gloss)\n    );\n\n    const types = computed<(\"plain\" | \"ipa\" | \"gloss\")[]>(() =>\n      canGloss.value ? [\"ipa\", \"gloss\"] : [\"plain\"]\n    );\n    const texts = computed(() =>\n      types.value.map((type) => props.state.texts?.map((text) => text[type]))\n    );\n    watch(\n      texts,\n      (texts) => {\n        if (!texts) return;\n        const lines = texts.map((t) => t?.join(\"\"));\n        const text = lines.length === 1 ? lines[0] : lines.join(\"\\n\");\n        emit(\"text\", text);\n      },\n      { immediate: true, deep: true }\n    );\n\n    const textColors = computed(() =>\n      props.state.texts\n        .map(({ entity }) => entity ?? \"\")\n        .map((e) => entities.value.indexOf(e))\n        .map((i) => \"colored-\" + i)\n    );\n    const dashColors = computed(() =>\n      props.state.transition && props.state.conditions\n        ? Object.entries(props.state.conditions)\n            .filter(([, tags]) => Object.values(tags).some((flag) => flag))\n            .map(([entity]) => entities.value.indexOf(entity))\n            .map((i) => \"colored-back-\" + i)\n        : []\n    );\n\n    return { types, texts, canGloss, textColors, dashColors };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=661aca89&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=661aca89&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-661aca89\"\n\nexport default script","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.es/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=380e7c9d&lang=scss&scoped=true\""],"sourceRoot":""}